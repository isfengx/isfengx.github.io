<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="google-site-verification" content="1rAjSg_LYunVt576r01InAPcRzfUpJ1sf6iiNhZPVwg" />













  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />





  <link rel="alternate" href="/atom.xml" title="今宵别梦寒" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico?v=5.1.1" />






<meta name="description" content="我希望能够远走，逃离我的所知，逃离我的所有。我想出发，去任何地方，不论是村庄或者荒原，只要不是这里就行。我向往的只是不再见到这些人，不再过这种没完没了的日子。我想做到的，是卸下我已习惯的伪装，成为另一个我，以此得到喘息。不幸的是，我在这些事情上从来都事与愿违。 ——佩索阿《惶然录》  1234567891011121314151617181920212223242526272829303132">
<meta property="og:type" content="article">
<meta property="og:title" content="逃离">
<meta property="og:url" content="http://tisfeng.com/2017/07/19/test2/index.html">
<meta property="og:site_name" content="今宵别梦寒">
<meta property="og:description" content="我希望能够远走，逃离我的所知，逃离我的所有。我想出发，去任何地方，不论是村庄或者荒原，只要不是这里就行。我向往的只是不再见到这些人，不再过这种没完没了的日子。我想做到的，是卸下我已习惯的伪装，成为另一个我，以此得到喘息。不幸的是，我在这些事情上从来都事与愿违。 ——佩索阿《惶然录》  1234567891011121314151617181920212223242526272829303132">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2017-08-04T15:51:27.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="逃离">
<meta name="twitter:description" content="我希望能够远走，逃离我的所知，逃离我的所有。我想出发，去任何地方，不论是村庄或者荒原，只要不是这里就行。我向往的只是不再见到这些人，不再过这种没完没了的日子。我想做到的，是卸下我已习惯的伪装，成为另一个我，以此得到喘息。不幸的是，我在这些事情上从来都事与愿违。 ——佩索阿《惶然录》  1234567891011121314151617181920212223242526272829303132">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"always","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '0T0DGBCSI6',
      apiKey: '73c7da3260db314bf43920a621de4e7a',
      indexName: 'hexo',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://tisfeng.com/2017/07/19/test2/"/>





  <title>逃离 | 今宵别梦寒</title>
  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?a28408894a1d0eab2dedfc11c944989d";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>










</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">今宵别梦寒</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">人生相感动 , 金石两青荧</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  
  <div class="algolia-popup popup search-popup">
    <div class="algolia-search">
      <div class="algolia-search-input-icon">
        <i class="fa fa-search"></i>
      </div>
      <div class="algolia-search-input" id="algolia-search-input"></div>
    </div>

    <div class="algolia-results">
      <div id="algolia-stats"></div>
      <div id="algolia-hits"></div>
      <div id="algolia-pagination" class="algolia-pagination"></div>
    </div>

    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
  </div>




    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  



  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://tisfeng.com/2017/07/19/test2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tisfeng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/You729.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="今宵别梦寒">
    </span>


    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">逃离</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-19T04:23:02+08:00">
                2017-07-19
              </time>
            

            

            
          </span>

          


 <!-- 在下面的位置加上如下代码 -->
      <span id="busuanzi_container_page_pv">
      &nbsp; | &nbsp; 热度&nbsp; <span id="busuanzi_value_page_pv"></span>°C
      </span>
 <!-- 在上面的位置加上如上代码 -->
 <br/>
  
          
            
              <span class="post-comments-count">
                <span class="post-meta-divider"></span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/07/19/test2/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/07/19/test2/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          



         
    

         <span class="post-time">
     &nbsp; | &nbsp;
           <span class="post-meta-item-icon">
             <i class="fa fa-file-word-o"></i>
           </span>
           <span class="post-meta-item-text">字数:</span>
           <span class="post-count">2,980字</span>
           
         </span>
    
      <span class="post-time">
     &nbsp; | &nbsp;
           <span class="post-meta-item-icon">
             <i class="fa fa-clock-o"></i>
           </span>
           <span class="post-meta-item-text">阅读:</span>
           <span class="post-count">15分钟</span>
           
         </span>


        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <link rel="stylesheet" type="text/css" href="/assets/css/DPlayer.min.css"><script src="/assets/js/DPlayer.min.js"> </script><script src="/assets/js/APlayer.min.js"> </script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>我希望能够远走，逃离我的所知，逃离我的所有。我想出发，去任何地方，不论是村庄或者荒原，只要不是这里就行。我向往的只是不再见到这些人，不再过这种没完没了的日子。我想做到的，是卸下我已习惯的伪装，成为另一个我，以此得到喘息。不幸的是，我在这些事情上从来都事与愿违。</p>
<p>——佩索阿《惶然录》</p>
<hr>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div><div class="line">340</div><div class="line">341</div><div class="line">342</div><div class="line">343</div><div class="line">344</div><div class="line">345</div><div class="line">346</div><div class="line">347</div><div class="line">348</div><div class="line">349</div><div class="line">350</div><div class="line">351</div><div class="line">352</div><div class="line">353</div><div class="line">354</div><div class="line">355</div><div class="line">356</div><div class="line">357</div><div class="line">358</div><div class="line">359</div><div class="line">360</div><div class="line">361</div><div class="line">362</div><div class="line">363</div><div class="line">364</div><div class="line">365</div><div class="line">366</div><div class="line">367</div><div class="line">368</div><div class="line">369</div><div class="line">370</div><div class="line">371</div><div class="line">372</div><div class="line">373</div><div class="line">374</div><div class="line">375</div><div class="line">376</div><div class="line">377</div><div class="line">378</div><div class="line">379</div><div class="line">380</div><div class="line">381</div><div class="line">382</div><div class="line">383</div><div class="line">384</div><div class="line">385</div><div class="line">386</div><div class="line">387</div><div class="line">388</div><div class="line">389</div><div class="line">390</div><div class="line">391</div><div class="line">392</div><div class="line">393</div><div class="line">394</div><div class="line">395</div><div class="line">396</div><div class="line">397</div><div class="line">398</div><div class="line">399</div><div class="line">400</div><div class="line">401</div><div class="line">402</div><div class="line">403</div><div class="line">404</div><div class="line">405</div><div class="line">406</div><div class="line">407</div><div class="line">408</div><div class="line">409</div><div class="line">410</div><div class="line">411</div><div class="line">412</div><div class="line">413</div><div class="line">414</div><div class="line">415</div><div class="line">416</div><div class="line">417</div><div class="line">418</div><div class="line">419</div><div class="line">420</div><div class="line">421</div><div class="line">422</div><div class="line">423</div><div class="line">424</div><div class="line">425</div><div class="line">426</div><div class="line">427</div><div class="line">428</div><div class="line">429</div><div class="line">430</div><div class="line">431</div><div class="line">432</div><div class="line">433</div><div class="line">434</div><div class="line">435</div><div class="line">436</div><div class="line">437</div><div class="line">438</div><div class="line">439</div><div class="line">440</div><div class="line">441</div><div class="line">442</div><div class="line">443</div><div class="line">444</div><div class="line">445</div><div class="line">446</div><div class="line">447</div><div class="line">448</div><div class="line">449</div><div class="line">450</div><div class="line">451</div><div class="line">452</div><div class="line">453</div><div class="line">454</div><div class="line">455</div><div class="line">456</div><div class="line">457</div><div class="line">458</div><div class="line">459</div><div class="line">460</div><div class="line">461</div><div class="line">462</div><div class="line">463</div><div class="line">464</div><div class="line">465</div><div class="line">466</div><div class="line">467</div><div class="line">468</div><div class="line">469</div><div class="line">470</div><div class="line">471</div><div class="line">472</div><div class="line">473</div><div class="line">474</div><div class="line">475</div><div class="line">476</div><div class="line">477</div><div class="line">478</div><div class="line">479</div><div class="line">480</div><div class="line">481</div><div class="line">482</div><div class="line">483</div><div class="line">484</div><div class="line">485</div><div class="line">486</div><div class="line">487</div><div class="line">488</div><div class="line">489</div><div class="line">490</div><div class="line">491</div><div class="line">492</div><div class="line">493</div><div class="line">494</div><div class="line">495</div><div class="line">496</div><div class="line">497</div><div class="line">498</div><div class="line">499</div><div class="line">500</div><div class="line">501</div><div class="line">502</div><div class="line">503</div><div class="line">504</div><div class="line">505</div><div class="line">506</div><div class="line">507</div><div class="line">508</div><div class="line">509</div><div class="line">510</div><div class="line">511</div><div class="line">512</div><div class="line">513</div><div class="line">514</div><div class="line">515</div><div class="line">516</div><div class="line">517</div><div class="line">518</div><div class="line">519</div><div class="line">520</div><div class="line">521</div><div class="line">522</div><div class="line">523</div><div class="line">524</div><div class="line">525</div><div class="line">526</div><div class="line">527</div><div class="line">528</div><div class="line">529</div><div class="line">530</div><div class="line">531</div><div class="line">532</div><div class="line">533</div><div class="line">534</div><div class="line">535</div><div class="line">536</div><div class="line">537</div><div class="line">538</div><div class="line">539</div><div class="line">540</div><div class="line">541</div><div class="line">542</div><div class="line">543</div><div class="line">544</div><div class="line">545</div><div class="line">546</div><div class="line">547</div><div class="line">548</div><div class="line">549</div><div class="line">550</div><div class="line">551</div><div class="line">552</div><div class="line">553</div><div class="line">554</div><div class="line">555</div><div class="line">556</div><div class="line">557</div><div class="line">558</div><div class="line">559</div><div class="line">560</div><div class="line">561</div><div class="line">562</div><div class="line">563</div><div class="line">564</div><div class="line">565</div><div class="line">566</div><div class="line">567</div><div class="line">568</div><div class="line">569</div><div class="line">570</div><div class="line">571</div><div class="line">572</div><div class="line">573</div><div class="line">574</div><div class="line">575</div><div class="line">576</div><div class="line">577</div><div class="line">578</div><div class="line">579</div><div class="line">580</div><div class="line">581</div><div class="line">582</div><div class="line">583</div><div class="line">584</div><div class="line">585</div><div class="line">586</div><div class="line">587</div><div class="line">588</div><div class="line">589</div><div class="line">590</div><div class="line">591</div><div class="line">592</div><div class="line">593</div><div class="line">594</div><div class="line">595</div><div class="line">596</div><div class="line">597</div><div class="line">598</div><div class="line">599</div><div class="line">600</div><div class="line">601</div><div class="line">602</div><div class="line">603</div><div class="line">604</div><div class="line">605</div><div class="line">606</div><div class="line">607</div><div class="line">608</div><div class="line">609</div><div class="line">610</div><div class="line">611</div><div class="line">612</div><div class="line">613</div><div class="line">614</div><div class="line">615</div><div class="line">616</div><div class="line">617</div><div class="line">618</div><div class="line">619</div><div class="line">620</div><div class="line">621</div><div class="line">622</div><div class="line">623</div><div class="line">624</div><div class="line">625</div><div class="line">626</div><div class="line">627</div><div class="line">628</div><div class="line">629</div><div class="line">630</div><div class="line">631</div><div class="line">632</div><div class="line">633</div><div class="line">634</div><div class="line">635</div><div class="line">636</div><div class="line">637</div><div class="line">638</div><div class="line">639</div><div class="line">640</div><div class="line">641</div><div class="line">642</div><div class="line">643</div><div class="line">644</div><div class="line">645</div><div class="line">646</div><div class="line">647</div><div class="line">648</div><div class="line">649</div><div class="line">650</div><div class="line">651</div><div class="line">652</div><div class="line">653</div><div class="line">654</div><div class="line">655</div><div class="line">656</div><div class="line">657</div><div class="line">658</div><div class="line">659</div><div class="line">660</div><div class="line">661</div><div class="line">662</div><div class="line">663</div><div class="line">664</div><div class="line">665</div><div class="line">666</div><div class="line">667</div><div class="line">668</div><div class="line">669</div><div class="line">670</div><div class="line">671</div><div class="line">672</div><div class="line">673</div><div class="line">674</div><div class="line">675</div><div class="line">676</div><div class="line">677</div><div class="line">678</div><div class="line">679</div><div class="line">680</div><div class="line">681</div><div class="line">682</div><div class="line">683</div><div class="line">684</div><div class="line">685</div><div class="line">686</div><div class="line">687</div><div class="line">688</div><div class="line">689</div><div class="line">690</div><div class="line">691</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//  AppDelegate.m</span></div><div class="line"><span class="comment">//  DDULearn</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//  Created by hxed on 2017/2/16.</span></div><div class="line"><span class="comment">//  Copyright © 2017年 WangXunfeng. All rights reserved.</span></div><div class="line"><span class="comment">//</span></div><div class="line"></div><div class="line"><span class="meta">#import <span class="meta-string">"AppDelegate.h"</span></span></div><div class="line"></div><div class="line"><span class="meta">#import <span class="meta-string">&lt;AMapFoundationKit/AMapFoundationKit.h&gt;</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">&lt;RongIMKit/RongIMKit.h&gt;</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">"IQKeyboardManager.h"</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">"MMDrawerController.h"</span></span></div><div class="line"></div><div class="line"><span class="meta">#import <span class="meta-string">"UXMainViewController.h"</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">"UXiCenterVC.h"</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">"UXRightVC.h"</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">"SDWebImageManager.h"</span></span></div><div class="line"><span class="meta">#import <span class="meta-string">"UXTestChatViewController.h"</span></span></div><div class="line"></div><div class="line"><span class="meta">#ifdef NSFoundationVersionNumber_iOS_9_x_Max</span></div><div class="line"><span class="meta">#import <span class="meta-string">&lt;UserNotifications/UserNotifications.h&gt;</span></span></div><div class="line"><span class="meta">#endif</span></div><div class="line"></div><div class="line"><span class="comment">// 引入JPush功能所需头文件</span></div><div class="line"><span class="meta">#import <span class="meta-string">"JPUSHService.h"</span></span></div><div class="line"><span class="comment">// iOS10注册APNs所需头文件</span></div><div class="line"><span class="meta">#ifdef NSFoundationVersionNumber_iOS_9_x_Max</span></div><div class="line"><span class="meta">#import <span class="meta-string">&lt;UserNotifications/UserNotifications.h&gt;</span></span></div><div class="line"><span class="meta">#endif</span></div><div class="line"><span class="comment">// 如果需要使用idfa功能所需要引入的头文件（可选）</span></div><div class="line"><span class="meta">#import <span class="meta-string">&lt;AdSupport/AdSupport.h&gt;</span></span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//  融云SDK</span></div><div class="line"><span class="keyword">static</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> RongYun_Key = <span class="string">@"6tnym1br6ggu7"</span>;</div><div class="line"><span class="keyword">static</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> RongYun_Secret = <span class="string">@"0KD08XfVd4c"</span>;</div><div class="line"></div><div class="line"><span class="comment">//  高德SDK</span></div><div class="line"><span class="keyword">static</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> GaoDeMap_Key = <span class="string">@"93d41a79fc16d0547e4aab4b666f4ef7"</span>;</div><div class="line"></div><div class="line"><span class="comment">//  Jpush</span></div><div class="line"><span class="keyword">static</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> Jpush_Key = <span class="string">@"fc769e9cabf9c93cd934f357"</span>;</div><div class="line"></div><div class="line"><span class="built_in">NSString</span> * RongYun_Token = <span class="string">@"oxVWw30bJDVDK6w86pzUjnpI92qiwflHGcNlXpMjR5OgQl65rAZZmJECboP7i7W4Rwsa8KU7gJU="</span>;</div><div class="line"><span class="comment">//static NSString * const RongYun_Key = @"6tnym1br6ggu7";</span></div><div class="line"><span class="comment">//static NSString * const RongYun_Secret = @"0KD08XfVd4c";</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="meta">#pragma mark 自己申请</span></div><div class="line"><span class="comment">//static NSString * const RongYun_Token = @"yPCseovW+OFtWuCqY4p+z6VDl2pMzSpFrURFGlPagKIM+qjDZZ1RqM03OeQE1xmUdyk2oHaS7EgUxS0VDXU8LTm06Yzc6HA6";</span></div><div class="line"><span class="comment">//static NSString * const RongYun_Key = @"6tnym1br6gbv7";</span></div><div class="line"></div><div class="line"><span class="comment">//static NSString * const GaoDeMap_Key = @"93d41a79fc16d0547e4aab4b666f4ef7";</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">AppDelegate</span> () &lt;<span class="title">RCIMUserInfoDataSource</span>, <span class="title">RCIMReceiveMessageDelegate</span>, <span class="title">UNUserNotificationCenterDelegate</span>, <span class="title">JPUSHRegisterDelegate</span>&gt;</span></div><div class="line">&#123;</div><div class="line">    <span class="built_in">UIView</span> * _navBackView;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>,<span class="keyword">strong</span>) MMDrawerController * drawerController;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">AppDelegate</span></span></div><div class="line"></div><div class="line"></div><div class="line">- (<span class="built_in">BOOL</span>)application:(<span class="built_in">UIApplication</span> *)application didFinishLaunchingWithOptions:(<span class="built_in">NSDictionary</span> *)launchOptions &#123;</div><div class="line">    </div><div class="line">    [<span class="keyword">self</span> setRootViewController];</div><div class="line">    [<span class="keyword">self</span> setNavBar];</div><div class="line">    [<span class="keyword">self</span> configSDK];</div><div class="line">    </div><div class="line">    [<span class="keyword">self</span> registerLogin];</div><div class="line">    </div><div class="line">    </div><div class="line">    [<span class="keyword">self</span> registerNotificationOnApplication:application];</div><div class="line">    </div><div class="line">    <span class="comment">// JPush 推送</span></div><div class="line">    </div><div class="line">    JPUSHRegisterEntity * entity = [[JPUSHRegisterEntity alloc] init];</div><div class="line">    entity.types = JPAuthorizationOptionAlert|JPAuthorizationOptionBadge|JPAuthorizationOptionSound;</div><div class="line">    <span class="keyword">if</span> ([[<span class="built_in">UIDevice</span> currentDevice].systemVersion floatValue] &gt;= <span class="number">8.0</span>) &#123;</div><div class="line">        </div><div class="line">        <span class="comment">// 可以添加自定义categories</span></div><div class="line">        <span class="comment">// NSSet&lt;UNNotificationCategory *&gt; *categories for iOS10 or later</span></div><div class="line">        <span class="comment">// NSSet&lt;UIUserNotificationCategory *&gt; *categories for iOS8 and iOS9</span></div><div class="line">        </div><div class="line">        [[UNUserNotificationCenter currentNotificationCenter] setNotificationCategories:[<span class="keyword">self</span> createNotificationCategoryActions]];</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    [JPUSHService registerForRemoteNotificationConfig:entity delegate:<span class="keyword">self</span>];</div><div class="line">    </div><div class="line">    </div><div class="line">    <span class="comment">// Optional</span></div><div class="line">    <span class="comment">// 获取IDFA</span></div><div class="line">    <span class="comment">// 如需使用IDFA功能请添加此代码并在初始化方法的advertisingIdentifier参数中填写对应值</span></div><div class="line">    <span class="built_in">NSString</span> *advertisingId = [[[ASIdentifierManager sharedManager] advertisingIdentifier] UUIDString];</div><div class="line">    </div><div class="line">    <span class="comment">// Required</span></div><div class="line">    <span class="comment">// init Push</span></div><div class="line">    <span class="comment">// notice: 2.1.5版本的SDK新增的注册方法，改成可上报IDFA，如果没有使用IDFA直接传nil</span></div><div class="line">    <span class="comment">// 如需继续使用pushConfig.plist文件声明appKey等配置内容，请依旧使用[JPUSHService setupWithOption:launchOptions]方式初始化。</span></div><div class="line">    [JPUSHService setupWithOption:launchOptions appKey:Jpush_Key</div><div class="line">                          channel:<span class="literal">nil</span></div><div class="line">                 apsForProduction:<span class="literal">NO</span></div><div class="line">            advertisingIdentifier:advertisingId];</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> <span class="literal">YES</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)test &#123;</div><div class="line">    </div><div class="line">    [<span class="keyword">self</span> configRongYunSDK];</div><div class="line">    </div><div class="line">    <span class="keyword">self</span>.window.rootViewController = [[<span class="built_in">UINavigationController</span> alloc] initWithRootViewController:[UXTestChatViewController new]];</div><div class="line">    </div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)setRootViewController &#123;</div><div class="line">    </div><div class="line">    <span class="built_in">UINavigationController</span> * mainNav = [[<span class="built_in">UINavigationController</span> alloc] initWithRootViewController:[UXMainViewController new]];</div><div class="line">    </div><div class="line">    <span class="built_in">UIView</span> * statuesBar = [[<span class="built_in">UIView</span> alloc] initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">-20</span>, WFKScreenWidth, <span class="number">20</span>)];</div><div class="line">    statuesBar.backgroundColor = [<span class="built_in">UIColor</span> whiteColor];</div><div class="line">    </div><div class="line">    </div><div class="line">    <span class="built_in">UINavigationController</span> * leftNav = [[<span class="built_in">UINavigationController</span> alloc] initWithRootViewController:[[UXiCenterVC alloc] init]];</div><div class="line">    </div><div class="line">    <span class="comment">//    UINavigationController * rightNav = [[UINavigationController alloc] initWithRootViewController:[WFTestVC new]];</span></div><div class="line">    </div><div class="line">    </div><div class="line">    <span class="comment">//    [leftNav.navigationBar addSubview:statuesBar];</span></div><div class="line">    </div><div class="line">    <span class="keyword">self</span>.drawerController = [[MMDrawerController alloc] initWithCenterViewController:mainNav leftDrawerViewController:leftNav rightDrawerViewController:<span class="literal">nil</span>];</div><div class="line">    </div><div class="line">    <span class="keyword">self</span>.drawerController.maximumLeftDrawerWidth = WFKScreenWidth*<span class="number">0.6</span>;</div><div class="line">    </div><div class="line">    <span class="comment">//4、设置打开/关闭抽屉的手势</span></div><div class="line">    <span class="keyword">self</span>.drawerController.openDrawerGestureModeMask = MMOpenDrawerGestureModeAll;</div><div class="line">    <span class="keyword">self</span>.drawerController.closeDrawerGestureModeMask =MMCloseDrawerGestureModeAll;</div><div class="line">    </div><div class="line">    <span class="keyword">self</span>.navigationVC = mainNav;</div><div class="line">    </div><div class="line">    <span class="keyword">self</span>.window = [[<span class="built_in">UIWindow</span> alloc]initWithFrame:[<span class="built_in">UIScreen</span> mainScreen].bounds];</div><div class="line">    [<span class="keyword">self</span>.window setRootViewController:<span class="keyword">self</span>.drawerController];</div><div class="line">    [<span class="keyword">self</span>.window makeKeyAndVisible];</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> 设置导航栏</div><div class="line"> */</div><div class="line">- (<span class="keyword">void</span>)setNavBar &#123;</div><div class="line">    </div><div class="line">    <span class="comment">//    设置左右按钮的颜色</span></div><div class="line">    [[<span class="built_in">UINavigationBar</span> appearance] setTintColor:[<span class="built_in">UIColor</span> blackColor]];</div><div class="line">    <span class="comment">//    修改导航条的背景色</span></div><div class="line">    [[<span class="built_in">UINavigationBar</span> appearance] setBarTintColor:[<span class="built_in">UIColor</span> whiteColor]];</div><div class="line">    </div><div class="line">    [<span class="built_in">UINavigationBar</span> appearance].backgroundColor = [<span class="built_in">UIColor</span> whiteColor];</div><div class="line">    <span class="comment">//    [[UINavigationBar appearance] setBackgroundImage:[UIImage imageNamed:@"navbar_bg_image"] forBarMetrics:UIBarMetricsDefault];</span></div><div class="line">    [[<span class="built_in">UINavigationBar</span> appearance] setShadowImage:[[<span class="built_in">UIImage</span> alloc] init]];</div><div class="line">    </div><div class="line">    <span class="built_in">NSDictionary</span> * attributesDic = @&#123;<span class="built_in">NSForegroundColorAttributeName</span>:[<span class="built_in">UIColor</span> blackColor],</div><div class="line">                                     <span class="built_in">NSFontAttributeName</span>:[<span class="built_in">UIFont</span> systemFontOfSize:<span class="number">16</span>]</div><div class="line">                                     &#125;;</div><div class="line">    <span class="comment">//    修改中间title的属性</span></div><div class="line">    [[<span class="built_in">UINavigationBar</span> appearance] setTitleTextAttributes:attributesDic];</div><div class="line">    </div><div class="line">    [[<span class="built_in">UINavigationBar</span> appearance] setBarStyle:<span class="built_in">UIBarStyleDefault</span>];</div><div class="line">    <span class="comment">//    设置状态栏样式</span></div><div class="line">    [<span class="built_in">UIApplication</span> sharedApplication].statusBarStyle = <span class="built_in">UIStatusBarStyleDefault</span>;</div><div class="line">    </div><div class="line">    <span class="comment">//    self.navigationController.navigationBar.barStyle = UIBarStyleBlack;</span></div><div class="line">    </div><div class="line">    </div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)configSDK &#123;</div><div class="line">    </div><div class="line">    <span class="comment">//    自动适应弹出键盘</span></div><div class="line">    [[IQKeyboardManager sharedManager] setCanAdjustTextView:<span class="literal">YES</span>];</div><div class="line">    [[IQKeyboardManager sharedManager] setShouldResignOnTouchOutside:<span class="literal">YES</span>];</div><div class="line">    </div><div class="line">    <span class="comment">//    高德地图 SDK</span></div><div class="line">    [AMapServices sharedServices].apiKey = GaoDeMap_Key;</div><div class="line">    </div><div class="line">    <span class="comment">//    配置融云SDK</span></div><div class="line">    <span class="comment">//    [self configRongYunSDK];</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//    配置融云SDK</span></div><div class="line">- (<span class="keyword">void</span>)configRongYunSDK</div><div class="line">&#123;</div><div class="line">    UXUserInfo * user = [<span class="built_in">NSKeyedUnarchiver</span> unarchiveObjectWithFile:KUserFile];</div><div class="line">    </div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"user: %@"</span>,user);</div><div class="line">    [RCIM sharedRCIM].portraitImageViewCornerRadius = <span class="number">0</span>;</div><div class="line">    [[RCIM sharedRCIM] initWithAppKey:RongYun_Key];</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> (!user.cloudToken) &#123;</div><div class="line">        </div><div class="line">        user.cloudToken = RongYun_Token;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"token: %@"</span>,user.cloudToken);</div><div class="line">    </div><div class="line">    [[RCIM sharedRCIM] disconnect:<span class="literal">YES</span>];</div><div class="line">    [[RCIM sharedRCIM] setEnableMessageAttachUserInfo:<span class="literal">YES</span>];</div><div class="line">    </div><div class="line">    </div><div class="line">    [[RCIM sharedRCIM] connectWithToken:user.cloudToken success:^(<span class="built_in">NSString</span> *userId) &#123;</div><div class="line">        </div><div class="line">        [[RCIM sharedRCIM] setEnableMessageRecall:<span class="literal">YES</span>];</div><div class="line">        </div><div class="line">        [[RCIM sharedRCIM] setReceiveMessageDelegate:<span class="keyword">self</span>];</div><div class="line">        [[RCIM sharedRCIM] setUserInfoDataSource:<span class="keyword">self</span>];</div><div class="line">        </div><div class="line">        RCUserInfo * userInfo = [[RCUserInfo alloc] init];</div><div class="line">        userInfo.userId = userId;</div><div class="line">        userInfo.name = user.nickName;</div><div class="line">        userInfo.portraitUri = user.headImg;</div><div class="line">        </div><div class="line">        [[RCIM sharedRCIM] setCurrentUserInfo:userInfo];</div><div class="line">        </div><div class="line">        </div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"登陆成功。当前登录的用户ID：%@"</span>, userId);</div><div class="line">        </div><div class="line">    &#125; error:^(RCConnectErrorCode status) &#123;</div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"登陆的错误码为:%ld"</span>, (<span class="keyword">long</span>)status);</div><div class="line">    &#125; tokenIncorrect:^&#123;</div><div class="line">        <span class="comment">//token过期或者不正确。</span></div><div class="line">        <span class="comment">//如果设置了token有效期并且token过期，请重新请求您的服务器获取新的token</span></div><div class="line">        <span class="comment">//如果没有设置token有效期却提示token错误，请检查您客户端和服务器的appkey是否匹配，还有检查您获取token的流程。</span></div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"token错误"</span>);</div><div class="line">    &#125;];</div><div class="line">    </div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)registerNotificationOnApplication:(<span class="built_in">UIApplication</span> *)application &#123;</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> ([[<span class="built_in">UIDevice</span> currentDevice].systemVersion floatValue] &gt;= <span class="number">10.0</span>) &#123;</div><div class="line">        <span class="comment">//iOS10特有</span></div><div class="line">        UNUserNotificationCenter *center = [UNUserNotificationCenter currentNotificationCenter];</div><div class="line">        <span class="comment">// 必须写代理，不然无法监听通知的接收与点击</span></div><div class="line">        center.delegate = <span class="keyword">self</span>;</div><div class="line">        [center requestAuthorizationWithOptions:(UNAuthorizationOptionAlert | UNAuthorizationOptionBadge | UNAuthorizationOptionSound) completionHandler:^(<span class="built_in">BOOL</span> granted, <span class="built_in">NSError</span> * _Nullable error) &#123;</div><div class="line">            <span class="keyword">if</span> (granted) &#123;</div><div class="line">                <span class="comment">// 点击允许通知</span></div><div class="line">                <span class="built_in">NSLog</span>(<span class="string">@"注册成功"</span>);</div><div class="line">                [center getNotificationSettingsWithCompletionHandler:^(UNNotificationSettings * _Nonnull settings) &#123;</div><div class="line">                    </div><div class="line">                    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, settings);</div><div class="line">                &#125;];</div><div class="line">                </div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                <span class="comment">// 点击不允许</span></div><div class="line">                <span class="built_in">NSLog</span>(<span class="string">@"注册失败"</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;];</div><div class="line">        </div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> ([[<span class="built_in">UIDevice</span> currentDevice].systemVersion floatValue] &gt;<span class="number">8.0</span>) &#123;</div><div class="line">        <span class="comment">//iOS8 - iOS10</span></div><div class="line">        [application registerUserNotificationSettings:[<span class="built_in">UIUserNotificationSettings</span> settingsForTypes:<span class="built_in">UIUserNotificationTypeAlert</span> | <span class="built_in">UIUserNotificationTypeSound</span> | <span class="built_in">UIUserNotificationTypeBadge</span> categories:<span class="literal">nil</span>]];</div><div class="line">        </div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> ([[<span class="built_in">UIDevice</span> currentDevice].systemVersion floatValue] &lt; <span class="number">8.0</span>) &#123;</div><div class="line">        <span class="comment">//iOS8系统以下</span></div><div class="line">        [application registerForRemoteNotificationTypes:<span class="built_in">UIRemoteNotificationTypeBadge</span> | <span class="built_in">UIRemoteNotificationTypeAlert</span> | <span class="built_in">UIRemoteNotificationTypeSound</span>];</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">    [<span class="keyword">self</span> timeNotificationTest];</div><div class="line">    </div><div class="line">    <span class="comment">// 注册获得device Token</span></div><div class="line">    [[<span class="built_in">UIApplication</span> sharedApplication] registerForRemoteNotifications];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//  测试本地时间通知</span></div><div class="line">- (<span class="keyword">void</span>)timeNotificationTest &#123;</div><div class="line">    </div><div class="line">    <span class="comment">// 1、创建通知内容，注：这里得用可变类型的UNMutableNotificationContent，否则内容的属性是只读的</span></div><div class="line">    UNMutableNotificationContent *content = [[UNMutableNotificationContent alloc] init];</div><div class="line">    <span class="comment">// 标题</span></div><div class="line">    content.title = <span class="string">@"柯梵通知"</span>;</div><div class="line">    <span class="comment">// 次标题</span></div><div class="line">    content.subtitle = <span class="string">@"柯梵办公室通知"</span>;</div><div class="line">    <span class="comment">// 内容</span></div><div class="line">    content.body = <span class="string">@"柯梵科技是一家以人为本，具有强烈社会责任感的公司。公司的最大愿景就是每个员工都能住上大房子，开上好车，实现逆袭高富帅、白富美的愿望。"</span>;</div><div class="line">    </div><div class="line">    <span class="comment">//                self.badge++;</span></div><div class="line">    <span class="comment">// app显示通知数量的角标</span></div><div class="line">    content.badge = @(<span class="number">9</span>);</div><div class="line">    </div><div class="line">    <span class="comment">// 通知的提示声音，这里用的默认的声音</span></div><div class="line">    content.sound = [UNNotificationSound defaultSound];</div><div class="line">    </div><div class="line">    <span class="built_in">NSURL</span> *imageUrl = [[<span class="built_in">NSBundle</span> mainBundle] URLForResource:<span class="string">@"Leaf"</span> withExtension:<span class="string">@"jpg"</span>];</div><div class="line">    </div><div class="line">    imageUrl = [<span class="built_in">NSURL</span> fileURLWithPath:[[<span class="built_in">NSBundle</span> mainBundle] pathForResource:<span class="string">@"Leaf.jpg"</span> ofType:<span class="literal">nil</span>]];</div><div class="line">    </div><div class="line">    UNNotificationAttachment *attachment = [UNNotificationAttachment attachmentWithIdentifier:<span class="string">@"imageIndetifier"</span> URL:imageUrl options:<span class="literal">nil</span> error:<span class="literal">nil</span>];</div><div class="line">    </div><div class="line">    <span class="comment">// 附件 可以是音频、图片、视频 这里是一张图片</span></div><div class="line">    content.attachments = @[attachment];</div><div class="line">    </div><div class="line">    <span class="comment">// 标识符</span></div><div class="line">    content.categoryIdentifier = <span class="string">@"categoryIndentifier"</span>;</div><div class="line">    </div><div class="line">    </div><div class="line">    <span class="comment">// 2、创建通知触发</span></div><div class="line">    <span class="comment">/* 触发器分三种：</span></div><div class="line">     UNTimeIntervalNotificationTrigger : 在一定时间后触发，如果设置重复的话，timeInterval不能小于60</div><div class="line">     UNCalendarNotificationTrigger : 在某天某时触发，可重复</div><div class="line">     UNLocationNotificationTrigger : 进入或离开某个地理区域时触发</div><div class="line">     */</div><div class="line">    UNTimeIntervalNotificationTrigger *trigger = [UNTimeIntervalNotificationTrigger triggerWithTimeInterval:<span class="number">7</span> repeats:<span class="literal">NO</span>];</div><div class="line">    </div><div class="line">    <span class="comment">//在每周一的16点3分提醒</span></div><div class="line">    <span class="built_in">NSDateComponents</span> *components = [[<span class="built_in">NSDateComponents</span> alloc] init];</div><div class="line">    components.weekday = <span class="number">2</span>;</div><div class="line">    components.hour = <span class="number">16</span>;</div><div class="line">    components.minute = <span class="number">3</span>;</div><div class="line">    <span class="comment">// components 日期</span></div><div class="line">    UNCalendarNotificationTrigger *calendarTrigger = [UNCalendarNotificationTrigger triggerWithDateMatchingComponents:components repeats:<span class="literal">YES</span>];</div><div class="line">    </div><div class="line">    </div><div class="line">    [[UNUserNotificationCenter currentNotificationCenter] setNotificationCategories:[<span class="keyword">self</span> createNotificationCategoryActions]];</div><div class="line">    </div><div class="line">    <span class="comment">// 3、创建通知请求</span></div><div class="line">    UNNotificationRequest *notificationRequest = [UNNotificationRequest requestWithIdentifier:<span class="string">@"KFGroupNotification"</span> content:content trigger:trigger];</div><div class="line">    </div><div class="line">    <span class="comment">// 4、将请求加入通知中心</span></div><div class="line">    [[UNUserNotificationCenter currentNotificationCenter] addNotificationRequest:notificationRequest withCompletionHandler:^(<span class="built_in">NSError</span> * _Nullable error) &#123;</div><div class="line">        <span class="keyword">if</span> (error == <span class="literal">nil</span>) &#123;</div><div class="line">            <span class="built_in">NSLog</span>(<span class="string">@"已成功加推送：%@"</span>,notificationRequest.identifier);</div><div class="line">        &#125;</div><div class="line">    &#125;];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 获得Device Token</span></div><div class="line">- (<span class="keyword">void</span>)application:(<span class="built_in">UIApplication</span> *)application didRegisterForRemoteNotificationsWithDeviceToken:(<span class="built_in">NSData</span> *)deviceToken &#123;</div><div class="line">    </div><div class="line">    <span class="comment">/// Required - 注册 DeviceToken</span></div><div class="line">    [JPUSHService registerDeviceToken:deviceToken];</div><div class="line">    </div><div class="line">    </div><div class="line">    <span class="comment">//     &lt;724e4406 f3c3e15b ee88587b e5c0db16 96c917d4 ab769fb5 b725e68f cc5700ca&gt;</span></div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"Device Token: %@"</span>, deviceToken]);</div><div class="line">&#125;</div><div class="line"><span class="comment">// 获得Device Token失败</span></div><div class="line">- (<span class="keyword">void</span>)application:(<span class="built_in">UIApplication</span> *)application</div><div class="line">didFailToRegisterForRemoteNotificationsWithError:(<span class="built_in">NSError</span> *)error &#123;</div><div class="line">    </div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"did Fail To Register For Remote Notifications With Error: %@"</span>, error);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// iOS 10收到通知，如果在想应用内展示通知 （如果不想在应用内展示，可以不实现这个方法）</span></div><div class="line">- (<span class="keyword">void</span>)userNotificationCenter:(UNUserNotificationCenter *)center willPresentNotification:(UNNotification *)notification withCompletionHandler:(<span class="keyword">void</span> (^)(UNNotificationPresentationOptions options))completionHandler &#123;</div><div class="line">    </div><div class="line">    <span class="built_in">NSDictionary</span> * userInfo = notification.request.content.userInfo;</div><div class="line">    UNNotificationRequest *request = notification.request; <span class="comment">// 收到推送的请求</span></div><div class="line">    UNNotificationContent *content = request.content; <span class="comment">// 收到推送的消息内容</span></div><div class="line">    <span class="built_in">NSNumber</span> *badge = content.badge;  <span class="comment">// 推送消息的角标</span></div><div class="line">    <span class="built_in">NSString</span> *body = content.body;    <span class="comment">// 推送消息体</span></div><div class="line">    UNNotificationSound *sound = content.sound;  <span class="comment">// 推送消息的声音</span></div><div class="line">    <span class="built_in">NSString</span> *subtitle = content.subtitle;  <span class="comment">// 推送消息的副标题</span></div><div class="line">    <span class="built_in">NSString</span> *title = content.title;  <span class="comment">// 推送消息的标题</span></div><div class="line">    </div><div class="line">    <span class="keyword">if</span>([notification.request.trigger isKindOfClass:[UNPushNotificationTrigger <span class="keyword">class</span>]]) &#123;</div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"iOS10 前台收到远程通知:%@"</span>, userInfo);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span> &#123;</div><div class="line">        <span class="comment">// 判断为本地通知</span></div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"iOS10 前台收到本地通知:&#123;\\\\nbody:%@，\\\\ntitle:%@,\\\\nsubtitle:%@,\\\\nbadge：%@，\\\\nsound：%@，\\\\nuserInfo：%@\\\\n&#125;"</span>,body,title,subtitle,badge,sound,userInfo);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"center: %@, current: %@"</span>,center,[UNUserNotificationCenter currentNotificationCenter]);</div><div class="line">    </div><div class="line">    [[UNUserNotificationCenter currentNotificationCenter] setNotificationCategories:[<span class="keyword">self</span> createNotificationCategoryActions]];</div><div class="line">    </div><div class="line">    </div><div class="line">    <span class="comment">// Required</span></div><div class="line">    <span class="keyword">if</span>([notification.request.trigger isKindOfClass:[UNPushNotificationTrigger <span class="keyword">class</span>]]) &#123;</div><div class="line">        [JPUSHService handleRemoteNotification:userInfo];</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">// 需要执行这个方法，选择是否提醒用户，有Badge、Sound、Alert三种类型可以设置</span></div><div class="line">    completionHandler(UNNotificationPresentationOptionBadge | UNNotificationPresentationOptionSound | UNNotificationPresentationOptionAlert);</div><div class="line">&#125;</div><div class="line">- (<span class="keyword">void</span>)didReceiveNotification:(UNNotification *)notification &#123;</div><div class="line">    </div><div class="line">&#125;</div><div class="line"><span class="comment">// 通知的点击事件</span></div><div class="line">- (<span class="keyword">void</span>)userNotificationCenter:(UNUserNotificationCenter *)center didReceiveNotificationResponse:(UNNotificationResponse *)response withCompletionHandler:(<span class="keyword">void</span>(^)())completionHandler &#123;</div><div class="line">    </div><div class="line">    <span class="built_in">NSDictionary</span> * userInfo = response.notification.request.content.userInfo;</div><div class="line">    UNNotificationRequest *request = response.notification.request; <span class="comment">// 收到推送的请求</span></div><div class="line">    UNNotificationContent *content = request.content; <span class="comment">// 收到推送的消息内容</span></div><div class="line">    <span class="built_in">NSNumber</span> *badge = content.badge;  <span class="comment">// 推送消息的角标</span></div><div class="line">    <span class="built_in">NSString</span> *body = content.body;    <span class="comment">// 推送消息体</span></div><div class="line">    UNNotificationSound *sound = content.sound;  <span class="comment">// 推送消息的声音</span></div><div class="line">    <span class="built_in">NSString</span> *subtitle = content.subtitle;  <span class="comment">// 推送消息的副标题</span></div><div class="line">    <span class="built_in">NSString</span> *title = content.title;  <span class="comment">// 推送消息的标题</span></div><div class="line">    </div><div class="line">    <span class="keyword">if</span> ([response.actionIdentifier isEqualToString:<span class="string">@"see1"</span>]) &#123;</div><div class="line">        <span class="comment">//I love it~的处理</span></div><div class="line">        </div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> ([response.actionIdentifier isEqualToString:<span class="string">@"see2"</span>]) &#123;</div><div class="line">        <span class="comment">//I don't care~</span></div><div class="line">        [[UNUserNotificationCenter currentNotificationCenter] removeDeliveredNotificationsWithIdentifiers:@[response.notification.request.identifier]];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> ([response.actionIdentifier isEqualToString:<span class="string">@"text"</span>]) &#123;</div><div class="line">        </div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">if</span>([response.notification.request.trigger isKindOfClass:[UNPushNotificationTrigger <span class="keyword">class</span>]]) &#123;</div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"iOS10 收到远程通知:%@"</span>, userInfo);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span> &#123;</div><div class="line">        <span class="comment">// 判断为本地通知</span></div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"iOS10 收到本地通知:&#123;\\\\nbody:%@，\\\\ntitle:%@,\\\\nsubtitle:%@,\\\\nbadge：%@，\\\\nsound：%@，\\\\nuserInfo：%@\\\\n&#125;"</span>,body,title,subtitle,badge,sound,userInfo);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">// Required</span></div><div class="line">    <span class="keyword">if</span>([response.notification.request.trigger isKindOfClass:[UNPushNotificationTrigger <span class="keyword">class</span>]]) &#123;</div><div class="line">        [JPUSHService handleRemoteNotification:userInfo];</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    completionHandler();  <span class="comment">// 系统要求执行这个方法 🍃</span></div><div class="line">    </div><div class="line">    <span class="comment">//    http://www.cnblogs.com/oc-bowen/p/6061280.html</span></div><div class="line">    </div><div class="line">    </div><div class="line">    <span class="comment">//    风葉子  星夜飘零的风叶子  止步不前的龃龉  麻仓子叶  木叶夕阳  暮色夕阳 fenng 云岚的风叶子🍃 岚风的叶子🍃  岚山风叶子木  星夜云岚一叶风   潇湘夜雨冷从今</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="built_in">NSSet</span> *)createNotificationCategoryActions &#123;</div><div class="line">    </div><div class="line">    <span class="comment">//定义按钮的交互button action</span></div><div class="line">    UNNotificationAction * likeButton = [UNNotificationAction actionWithIdentifier:<span class="string">@"see1"</span> title:<span class="string">@"I love it~"</span> options:UNNotificationActionOptionDestructive|UNNotificationActionOptionForeground];</div><div class="line">    UNNotificationAction * dislikeButton = [UNNotificationAction actionWithIdentifier:<span class="string">@"see2"</span> title:<span class="string">@"I don't care~"</span> options:UNNotificationActionOptionAuthenticationRequired|UNNotificationActionOptionDestructive|UNNotificationActionOptionForeground];</div><div class="line">    <span class="comment">//定义文本框的action</span></div><div class="line">    UNTextInputNotificationAction * text = [UNTextInputNotificationAction actionWithIdentifier:<span class="string">@"text"</span> title:<span class="string">@"How about it~?"</span> options:UNNotificationActionOptionDestructive|UNNotificationActionOptionForeground];</div><div class="line">    </div><div class="line">    <span class="comment">//将这些action带入category</span></div><div class="line">    UNNotificationCategory * choseCategory = [UNNotificationCategory categoryWithIdentifier:<span class="string">@"seeCategory"</span> actions:@[likeButton,dislikeButton] intentIdentifiers:@[<span class="string">@"see1"</span>,<span class="string">@"see2"</span>] options:UNNotificationCategoryOptionCustomDismissAction];</div><div class="line">    </div><div class="line">    UNNotificationCategory * comment = [UNNotificationCategory categoryWithIdentifier:<span class="string">@"seeCategory1"</span> actions:@[text] intentIdentifiers:@[<span class="string">@"text"</span>] options:UNNotificationCategoryOptionNone];</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> [<span class="built_in">NSSet</span> setWithObjects:choseCategory,comment,<span class="literal">nil</span>];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)application:(<span class="built_in">UIApplication</span> *)application didReceiveRemoteNotification:(<span class="built_in">NSDictionary</span> *)userInfo &#123;</div><div class="line">    </div><div class="line">    [JPUSHService handleRemoteNotification:userInfo];</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"iOS6及以下系统，收到通知:%@"</span>, userInfo);</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)application:(<span class="built_in">UIApplication</span> *)application didReceiveRemoteNotification:(<span class="built_in">NSDictionary</span> *)userInfo fetchCompletionHandler: (<span class="keyword">void</span> (^)(<span class="built_in">UIBackgroundFetchResult</span>))completionHandler &#123;</div><div class="line">    </div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"iOS7及以上系统，收到通知:%@"</span>, userInfo);</div><div class="line">    [JPUSHService handleRemoteNotification:userInfo];</div><div class="line">    completionHandler(<span class="built_in">UIBackgroundFetchResultNewData</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//  注册后直接登录</span></div><div class="line">- (<span class="keyword">void</span>)registerLogin &#123;</div><div class="line">    </div><div class="line">    UXUserInfo * user = [<span class="built_in">NSKeyedUnarchiver</span> unarchiveObjectWithFile:KUserFile];</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> (!user.isLogin) &#123;</div><div class="line">        </div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="built_in">NSString</span> * token = [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%@_%@"</span>,user.mid,user.access_token];</div><div class="line">    </div><div class="line">    <span class="built_in">NSDictionary</span> * para = [<span class="built_in">NSDictionary</span> dictionaryWithObjectsAndKeys:user.mid,<span class="string">@"mid"</span>,token,<span class="string">@"access_token"</span>, <span class="literal">nil</span>];</div><div class="line">    </div><div class="line">    [[WFRequestManager shareManager] postWithUrlString:KRegisterLogin parameters:para result:^(<span class="keyword">id</span> dic, <span class="built_in">NSError</span> * error)</div><div class="line">     &#123;</div><div class="line">         <span class="keyword">if</span> (dic &amp;&amp; !error) &#123;</div><div class="line">             </div><div class="line">             user.isLogin = <span class="literal">YES</span>;</div><div class="line">             user.nickName = dic[<span class="string">@"data"</span>][<span class="string">@"nickName"</span>];</div><div class="line">             user.headImg = dic[<span class="string">@"data"</span>][<span class="string">@"headImg"</span>];</div><div class="line">             user.cloudToken = dic[<span class="string">@"data"</span>][<span class="string">@"cloudToken"</span>];</div><div class="line">             </div><div class="line">             <span class="built_in">NSLog</span>(<span class="string">@"cloudToken %@"</span>, user.cloudToken);</div><div class="line">             </div><div class="line">             </div><div class="line">             [[SDWebImageManager sharedManager] loadImageWithURL:[<span class="built_in">NSURL</span> URLWithString:user.headImg] options:SDWebImageRetryFailed progress:<span class="literal">nil</span> completed:^(<span class="built_in">UIImage</span> * _Nullable image, <span class="built_in">NSData</span> * _Nullable data, <span class="built_in">NSError</span> * _Nullable error, SDImageCacheType cacheType, <span class="built_in">BOOL</span> finished, <span class="built_in">NSURL</span> * _Nullable imageURL) &#123;</div><div class="line">                 </div><div class="line">                 user.avatarImg = image;</div><div class="line">                 </div><div class="line">                 <span class="built_in">NSLog</span>(<span class="string">@"-- login: %d"</span>,user.isLogin);</div><div class="line">                 </div><div class="line">                 [<span class="built_in">NSKeyedArchiver</span> archiveRootObject:user toFile:KUserFile];</div><div class="line">             &#125;];</div><div class="line">             </div><div class="line">             [<span class="keyword">self</span> configRongYunSDK];</div><div class="line">             </div><div class="line">         &#125; <span class="keyword">else</span> &#123;</div><div class="line">             </div><div class="line">             [<span class="keyword">self</span> configRongYunSDK];</div><div class="line">         &#125;</div><div class="line">         </div><div class="line">         <span class="built_in">NSLog</span>(<span class="string">@"--- ret: %@"</span>,[dic objectForKey:<span class="string">@"result"</span>][<span class="string">@"msg"</span>]);</div><div class="line">     &#125;];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/*!</span></div><div class="line"> 获取用户信息</div><div class="line"> </div><div class="line"> @param userId      用户ID</div><div class="line"> @param completion  获取用户信息完成之后需要执行的Block [userInfo:该用户ID对应的用户信息]</div><div class="line"> </div><div class="line"> @discussion SDK通过此方法获取用户信息并显示，请在completion中返回该用户ID对应的用户信息。</div><div class="line"> 在您设置了用户信息提供者之后，SDK在需要显示用户信息的时候，会调用此方法，向您请求用户信息用于显示。</div><div class="line"> */</div><div class="line">- (<span class="keyword">void</span>)getUserInfoWithUserId:(<span class="built_in">NSString</span> *)userId</div><div class="line">                   completion:(<span class="keyword">void</span> (^)(RCUserInfo *userInfo))completion</div><div class="line">&#123;</div><div class="line">    UXUserInfo * user = [<span class="built_in">NSKeyedUnarchiver</span> unarchiveObjectWithFile:KUserFile];</div><div class="line">    </div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"--- userId: %@"</span>,userId);</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> ([userId isEqualToString:user.mid]) &#123;</div><div class="line">        </div><div class="line">        RCUserInfo * userInfo = [[RCUserInfo alloc] init];</div><div class="line">        userInfo.userId = userId;</div><div class="line">        userInfo.name = user.nickName;</div><div class="line">        userInfo.portraitUri = user.headImg;</div><div class="line">        </div><div class="line">        <span class="keyword">return</span> completion(userInfo);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> ([userId isEqualToString:<span class="string">@"13397671157"</span>]) &#123;</div><div class="line">        </div><div class="line">        RCUserInfo * userInfo = [[RCUserInfo alloc] init];</div><div class="line">        userInfo.userId = userId;</div><div class="line">        userInfo.name = <span class="string">@"和上帝掷骰子"</span>;</div><div class="line">        userInfo.portraitUri = <span class="string">@"http://ww1.sinaimg.cn/thumb150/0069TUQujw8f40m60rxrej30e80e8dgb.jpg"</span>;</div><div class="line">        </div><div class="line">        <span class="keyword">return</span> completion(userInfo);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> ([userId isEqualToString:<span class="string">@"Youki"</span>]) &#123;</div><div class="line">        </div><div class="line">        RCUserInfo * userInfo = [[RCUserInfo alloc] init];</div><div class="line">        userInfo.userId = userId;</div><div class="line">        userInfo.name = <span class="string">@"Youki"</span>;</div><div class="line">        userInfo.portraitUri = <span class="string">@"http://ww1.sinaimg.cn/thumb150/0069TUQujw8f40m60rxrej30e80e8dgb.jpg"</span>;</div><div class="line">        </div><div class="line">        <span class="keyword">return</span> completion(userInfo);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> ([userId isEqualToString:<span class="string">@"729"</span>]) &#123;</div><div class="line">        </div><div class="line">        RCUserInfo * userInfo = [[RCUserInfo alloc] init];</div><div class="line">        userInfo.userId = userId;</div><div class="line">        userInfo.name = <span class="string">@"渐黄昏"</span>;</div><div class="line">        userInfo.portraitUri = <span class="string">@"http://ww1.sinaimg.cn/mw690/0069TUQugw1fa81keqfiuj30ku0rsacs.jpg"</span>;</div><div class="line">        </div><div class="line">        <span class="keyword">return</span> completion(userInfo);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">    <span class="keyword">if</span> ([userId isEqualToString:<span class="string">@"1"</span>]) &#123;</div><div class="line">        </div><div class="line">        RCUserInfo * userInfo = [[RCUserInfo alloc] init];</div><div class="line">        userInfo.userId = userId;</div><div class="line">        userInfo.name = <span class="string">@"系统消息"</span>;</div><div class="line">        userInfo.portraitUri = <span class="string">@"http://ww3.sinaimg.cn/mw690/0069TUQugw1f9qqkxql01j30qo0zkn2r.jpg"</span>;</div><div class="line">        </div><div class="line">        <span class="keyword">return</span> completion(userInfo);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">    RCUserInfo * userInfo = [[RCUserInfo alloc] init];</div><div class="line">    userInfo.userId = userId;</div><div class="line">    userInfo.name = [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"name_%@"</span>,userId];</div><div class="line">    </div><div class="line">    <span class="comment">//    userInfo.portraitUri = user.headImg;</span></div><div class="line">    </div><div class="line">    <span class="keyword">return</span> completion(userInfo);</div><div class="line">    </div><div class="line">    <span class="comment">//    return completion(nil);</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//接收消息的回调方法</span></div><div class="line">- (<span class="keyword">void</span>)onRCIMReceiveMessage:(RCMessage *)message left:(<span class="keyword">int</span>)left</div><div class="line">&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"-- receive message: %@(%@) %@ "</span>,message.targetId,message.senderUserId,message.content);</div><div class="line">    </div><div class="line">    RCTextMessage *txtMsg = (RCTextMessage*)message.content;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"new text: %@"</span>,txtMsg);</div><div class="line">    </div><div class="line">    [[<span class="built_in">NSNotificationCenter</span> defaultCenter] postNotificationName:<span class="string">@"newMessage"</span> object:@<span class="number">1</span>];</div><div class="line">    </div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//  查询用户位置授权</span></div><div class="line">- (<span class="keyword">void</span>)initCLLocationManager</div><div class="line">&#123;</div><div class="line">    <span class="comment">//定位服务是否可用</span></div><div class="line">    <span class="built_in">BOOL</span> enable = [<span class="built_in">CLLocationManager</span> locationServicesEnabled];</div><div class="line">    <span class="comment">//是否具有定位权限</span></div><div class="line">    <span class="keyword">int</span> status = [<span class="built_in">CLLocationManager</span> authorizationStatus];</div><div class="line">    <span class="keyword">if</span>(!enable || status &lt; <span class="number">3</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="comment">//请求权限</span></div><div class="line">        <span class="keyword">if</span> ([[<span class="built_in">UIDevice</span> currentDevice].systemVersion floatValue] &gt;= <span class="number">8</span>)</div><div class="line">        &#123;</div><div class="line">            <span class="comment">//由于IOS8中定位的授权机制改变 需要进行手动授权</span></div><div class="line">            <span class="built_in">CLLocationManager</span>  *locationManager = [[<span class="built_in">CLLocationManager</span> alloc] init];</div><div class="line">            <span class="comment">//获取授权认证</span></div><div class="line">            [locationManager requestAlwaysAuthorization];</div><div class="line">            [locationManager requestWhenInUseAuthorization];</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="built_in">UIAlertView</span> *alertView = [[<span class="built_in">UIAlertView</span> alloc] initWithTitle:<span class="literal">nil</span></div><div class="line">                                                            message:<span class="string">@"无法定位到您所在的城市，请前去开启GPS定位"</span></div><div class="line">                                                           delegate:<span class="keyword">self</span></div><div class="line">                                                  cancelButtonTitle:<span class="literal">nil</span></div><div class="line">                                                  otherButtonTitles:<span class="string">@"取消"</span>,<span class="string">@"去设置"</span>, <span class="literal">nil</span>];</div><div class="line">        alertView.tag = <span class="number">1000</span>;</div><div class="line">        [alertView show];</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">#pragma mark -- UIAlertViewDelegate</span></div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)alertView:(<span class="built_in">UIAlertView</span> *)alertView clickedButtonAtIndex:(<span class="built_in">NSInteger</span>)buttonIndex</div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> (buttonIndex == <span class="number">0</span>)</div><div class="line">    &#123;</div><div class="line">        </div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span></div><div class="line">    &#123;</div><div class="line">        [<span class="keyword">self</span> jumpSetting];</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)jumpSetting</div><div class="line">&#123;</div><div class="line">    <span class="comment">//打开设置页面，去设置定位</span></div><div class="line">    <span class="built_in">NSURL</span> *url = [<span class="built_in">NSURL</span> URLWithString:<span class="built_in">UIApplicationOpenSettingsURLString</span>];</div><div class="line">    <span class="keyword">if</span> ([[<span class="built_in">UIApplication</span> sharedApplication] canOpenURL:url])</div><div class="line">    &#123;</div><div class="line">        [[<span class="built_in">UIApplication</span> sharedApplication] openURL:url];</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)applicationWillResignActive:(<span class="built_in">UIApplication</span> *)application &#123;</div><div class="line">    <span class="comment">// Sent when the application is about to move from active to inactive state. This can occur for certain types of temporary interruptions (such as an incoming phone call or SMS message) or when the user quits the application and it begins the transition to the background state.</span></div><div class="line">    <span class="comment">// Use this method to pause ongoing tasks, disable timers, and invalidate graphics rendering callbacks. Games should use this method to pause the game.</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)applicationDidEnterBackground:(<span class="built_in">UIApplication</span> *)application &#123;</div><div class="line">    <span class="comment">// Use this method to release shared resources, save user data, invalidate timers, and store enough application state information to restore your application to its current state in case it is terminated later.</span></div><div class="line">    <span class="comment">// If your application supports background execution, this method is called instead of applicationWillTerminate: when the user quits.</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)applicationWillEnterForeground:(<span class="built_in">UIApplication</span> *)application &#123;</div><div class="line">    <span class="comment">// Called as part of the transition from the background to the active state; here you can undo many of the changes made on entering the background.</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)applicationDidBecomeActive:(<span class="built_in">UIApplication</span> *)application &#123;</div><div class="line">    <span class="comment">// Restart any tasks that were paused (or not yet started) while the application was inactive. If the application was previously in the background, optionally refresh the user interface.</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)applicationWillTerminate:(<span class="built_in">UIApplication</span> *)application &#123;</div><div class="line">    <span class="comment">// Called when the application is about to terminate. Save data if appropriate. See also applicationDidEnterBackground:.</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>

      
    </div>

<div style="text-align:center;color: #ccc;font-size:14px;">———————————————— The End ————————————————</div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/07/19/test/" rel="next" title="test">
                <i class="fa fa-chevron-left"></i> test
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/07/24/markdown-test/" rel="prev" title="markdown test">
                markdown test <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>




  




    <div class="post-spread">
      
        <!-- JiaThis Button BEGIN -->
<div class="jiathis_style">
  <a class="jiathis_button_tsina"></a>
  <a class="jiathis_button_weixin"></a>
  <a class="jiathis_button_cqq"></a>
  <a class="jiathis_button_douban"></a>
  <a class="jiathis_button_renren"></a>
  <a class="jiathis_button_qzone"></a>
  <a class="jiathis_button_copy"></a>
  <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
  <a class="jiathis_counter_style"></a>
</div>
<script type="text/javascript" >
  var jiathis_config={
    hideMore:false
  }
</script>
<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js" charset="utf-8"></script>
<!-- JiaThis Button END -->

      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    

    <div style="text-align:center;">
        <button class="btn" id="load-disqus" onclick="disqus.load();">加载 Disqus 评论</button>
    </div>

      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/You729.png"
               alt="Tisfeng" />
          <p class="site-author-name" itemprop="name">Tisfeng</p>
           
              <p class="site-description motion-element" itemprop="description">卦不敢算尽  |  畏天道无常 <br> 情不敢至深  |  恐大梦一场</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">33</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">7</span>
                <span class="site-state-item-name">分类</span>
              
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              
                <span class="site-state-item-count">13</span>
                <span class="site-state-item-name">标签</span>
              
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://twitter.com/tisfeng" target="_blank" title="Twitter">
                  
                    <i class="fa fa-fw fa-twitter"></i>
                  
                  Twitter
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              Links
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="https://www.shiyanlou.com/courses" title="实验楼" target="_blank">实验楼</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.imooc.com" title="慕课网" target="_blank">慕课网</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://www.w3cschool.cn" title="w3cschool" target="_blank">w3cschool</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://program-think.blogspot.com" title="编程随想" target="_blank">编程随想</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.ruanyifeng.com/blog" title="阮一峰" target="_blank">阮一峰</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://onevcat.com/#blog" title="OneV" target="_blank">OneV</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://macshuo.com" title="MacTalk" target="_blank">MacTalk</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://note.leodev.me" title="leodev" target="_blank">leodev</a>
                </li>
              
            </ul>
          </div>
        

        



      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Tisfeng</span>
</div>



<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link " href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>



&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;
  <span id="busuanzi_container_site_pv">
  <i class="fa fa-user" aria-hidden="true"></i>
  <span id="busuanzi_value_site_pv"></span>
  </span>
  &nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;
  <span id="busuanzi_container_site_uv">
  <i class="fa fa-eye" aria-hidden="true"></i>
  <span id="busuanzi_value_site_uv"></span>
  </span>

<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>


</div>





        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  

    
      <script id="dsq-count-scr" src="https://isfeng-1.disqus.com/count.js" async></script>
    

  
    
      <script type="text/javascript">
        var disqus_config = function () {
          this.page.url = 'http://tisfeng.com/2017/07/19/test2/';
          this.page.identifier = '2017/07/19/test2/';
          this.page.title = '逃离';
        };
        var d = document, s = d.createElement('script');
        s.src = 'https://isfeng-1.disqus.com/embed.js';
        s.setAttribute('data-timestamp', '' + +new Date());
        (d.head || d.body).appendChild(s);

        $('#load-disqus').html("评论加载中，请确保你有梯子，若评论长时间未加载则你可能翻墙失败...").fadeOut(9000); //加载后移除按钮
        
      </script>
    

  











  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>




  
  
  
  <link rel="stylesheet" href="/lib/algolia-instant-search/instantsearch.min.css">

  
  
  <script src="/lib/algolia-instant-search/instantsearch.min.js"></script>
  

  <script src="/js/src/algolia-search.js?v=5.1.1"></script>



  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  

  

  

  





</body>
</html>
