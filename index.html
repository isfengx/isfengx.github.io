<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="google-site-verification" content="1rAjSg_LYunVt576r01InAPcRzfUpJ1sf6iiNhZPVwg" />













  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />





  <link rel="alternate" href="/atom.xml" title="今宵别梦寒" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico?v=5.1.1" />






<meta name="description" content="卦不敢算尽  |  畏天道无常  情不敢至深  |  恐大梦一场">
<meta property="og:type" content="website">
<meta property="og:title" content="今宵别梦寒">
<meta property="og:url" content="http://tisfeng.com/index.html">
<meta property="og:site_name" content="今宵别梦寒">
<meta property="og:description" content="卦不敢算尽  |  畏天道无常  情不敢至深  |  恐大梦一场">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="今宵别梦寒">
<meta name="twitter:description" content="卦不敢算尽  |  畏天道无常  情不敢至深  |  恐大梦一场">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"always","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '0T0DGBCSI6',
      apiKey: '73c7da3260db314bf43920a621de4e7a',
      indexName: 'hexo',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://tisfeng.com/"/>





  <title>今宵别梦寒</title>
  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?a28408894a1d0eab2dedfc11c944989d";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>










</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">今宵别梦寒</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">人生相感动 , 金石两青荧</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  
  <div class="algolia-popup popup search-popup">
    <div class="algolia-search">
      <div class="algolia-search-input-icon">
        <i class="fa fa-search"></i>
      </div>
      <div class="algolia-search-input" id="algolia-search-input"></div>
    </div>

    <div class="algolia-results">
      <div id="algolia-stats"></div>
      <div id="algolia-hits"></div>
      <div id="algolia-pagination" class="algolia-pagination"></div>
    </div>

    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
  </div>




    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  



  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://tisfeng.com/2017/07/24/hexo添加音乐、视频/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tisfeng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/You729.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="今宵别梦寒">
    </span>


    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/24/hexo添加音乐、视频/" itemprop="url">hexo添加音乐、视频 (置顶test)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-24T02:20:31+08:00">
                2017-07-24
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/code/" itemprop="url" rel="index">
                    <span itemprop="name">code</span>
                  </a>
                </span>

                
                
              
            </span>
          


 <!-- 在下面的位置加上如下代码 -->


 <!-- 在上面的位置加上如上代码 -->

  
          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/07/24/hexo添加音乐、视频/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/07/24/hexo添加音乐、视频/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          



         
    

         <span class="post-time">
     &nbsp; | &nbsp;
           <span class="post-meta-item-icon">
             <i class="fa fa-file-word-o"></i>
           </span>
           <span class="post-meta-item-text">WordCount:</span>
           <span class="post-count">649字</span>
           
         </span>
    
      <span class="post-time">
     &nbsp; | &nbsp;
           <span class="post-meta-item-icon">
             <i class="fa fa-clock-o"></i>
           </span>
           <span class="post-meta-item-text">min2read:</span>
           <span class="post-count">3分钟</span>
           
         </span>



        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <hr>
<h1 id="暴力方式添加音乐、视频"><a href="#暴力方式添加音乐、视频" class="headerlink" title="暴力方式添加音乐、视频"></a>暴力方式添加音乐、视频</h1><p>因为markdown语法兼容html，所以一种简单的方法就是直接使用HTML嵌入</p>
<h2 id="插入音乐"><a href="#插入音乐" class="headerlink" title="插入音乐"></a>插入音乐</h2><p>去网易云音乐网站上找喜欢的歌，然后选择生成外链播放。下面这段代码就是由网易云上直接外链生成的（设置auto=1为自动播放）：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;iframe frameborder="no" border="0" marginwidth="0" </div><div class="line">marginheight="0" width=330 height=86 </div><div class="line">src="//music.163.com/outchain/player?type=2&amp;id=147030&amp;auto=0&amp;height=66"&gt;&lt;/iframe&gt;</div></pre></td></tr></table></figure>
<h2 id="插入视频"><a href="#插入视频" class="headerlink" title="插入视频"></a>插入视频</h2><p>和音乐类似视频也可以，像这个就是从YouTube视频上直接趴下来插入文本的</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;iframe frameborder="no" border="0" marginwidth="0" </div><div class="line">marginheight="0" width=330 height=86 </div><div class="line">src="//music.163.com/outchain/player?type=2&amp;id=147030&amp;auto=1&amp;height=66"&gt;&lt;/iframe&gt;</div></pre></td></tr></table></figure>
<iframe width="640" height="360" src="https://www.youtube.com/embed/NwfolzojHCY" frameborder="0" allowfullscreen></iframe>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2017/07/24/hexo添加音乐、视频/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

<div style="text-align:center;color: #ccc;font-size:14px;">—————————————— The End ——————————————</div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>





    
      

  

  
  
  



  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://tisfeng.com/2017/07/15/青春/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tisfeng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/You729.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="今宵别梦寒">
    </span>


    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/15/青春/" itemprop="url">青春 (置顶测试5)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-15T14:21:58+08:00">
                2017-07-15
              </time>
            

            

            
          </span>

          


 <!-- 在下面的位置加上如下代码 -->


 <!-- 在上面的位置加上如上代码 -->

  
          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/07/15/青春/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/07/15/青春/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          



         
    

         <span class="post-time">
     &nbsp; | &nbsp;
           <span class="post-meta-item-icon">
             <i class="fa fa-file-word-o"></i>
           </span>
           <span class="post-meta-item-text">WordCount:</span>
           <span class="post-count">536字</span>
           
         </span>
    
      <span class="post-time">
     &nbsp; | &nbsp;
           <span class="post-meta-item-icon">
             <i class="fa fa-clock-o"></i>
           </span>
           <span class="post-meta-item-text">min2read:</span>
           <span class="post-count">3分钟</span>
           
         </span>



        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>所有的结局都已写好<br>所有的泪水也都已启程<br>却忽然忘了是怎麽样的一个开始<br>在那个古老的不再回来的夏日<br>无论我如何地去追索<br>年轻的你只如云影掠过<br>而你微笑的面容极浅极淡<br>逐渐隐没在日落後的群岚<br>遂翻开那发黄的扉页<br>命运将它装订得极为拙劣<br>含著泪 我一读再读<br>却不得不承认<br>青春是一本太仓促的书</p>
<p>—— 席慕蓉</p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2017/07/15/青春/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

<div style="text-align:center;color: #ccc;font-size:14px;">—————————————— The End ——————————————</div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>





    
      

  

  
  
  



  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://tisfeng.com/2017/08/02/nginx-制作谷歌镜像/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tisfeng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/You729.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="今宵别梦寒">
    </span>


    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/02/nginx-制作谷歌镜像/" itemprop="url">nginx 制作谷歌镜像</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-02T21:48:56+08:00">
                2017-08-02
              </time>
            

            

            
          </span>

          


 <!-- 在下面的位置加上如下代码 -->


 <!-- 在上面的位置加上如上代码 -->

  
          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/08/02/nginx-制作谷歌镜像/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/08/02/nginx-制作谷歌镜像/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          



         
    

         <span class="post-time">
     &nbsp; | &nbsp;
           <span class="post-meta-item-icon">
             <i class="fa fa-file-word-o"></i>
           </span>
           <span class="post-meta-item-text">WordCount:</span>
           <span class="post-count">100字</span>
           
         </span>
    
      <span class="post-time">
     &nbsp; | &nbsp;
           <span class="post-meta-item-icon">
             <i class="fa fa-clock-o"></i>
           </span>
           <span class="post-meta-item-text">min2read:</span>
           <span class="post-count">1分钟</span>
           
         </span>



        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <link rel="stylesheet" type="text/css" href="/assets/css/DPlayer.min.css"><script src="/assets/js/DPlayer.min.js"> </script><script src="/assets/js/APlayer.min.js"> </script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><hr>
<h1 id="失败O-O"><a href="#失败O-O" class="headerlink" title="失败O..O"></a>失败O..O</h1><p>以前还不习惯翻墙的时候，想查点资料都是去网上找别人的谷歌镜像用，现在有了自己的服务器也好想做个自己的镜像。以为很简单然而搞了一整天还是不行。。。网上的教程似乎都点问题，不怎么靠谱</p>
<p>再试一试，还不行就先放下吧。</p>
<p>留坑</p>

          
        
      
    </div>

<div style="text-align:center;color: #ccc;font-size:14px;">—————————————— The End ——————————————</div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>





    
      

  

  
  
  



  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://tisfeng.com/2017/07/31/hexo 小记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tisfeng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/You729.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="今宵别梦寒">
    </span>


    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/31/hexo 小记/" itemprop="url">hexo 小记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-31T21:01:18+08:00">
                2017-07-31
              </time>
            

            

            
          </span>

          


 <!-- 在下面的位置加上如下代码 -->


 <!-- 在上面的位置加上如上代码 -->

  
          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/07/31/hexo 小记/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/07/31/hexo 小记/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          



         
    

         <span class="post-time">
     &nbsp; | &nbsp;
           <span class="post-meta-item-icon">
             <i class="fa fa-file-word-o"></i>
           </span>
           <span class="post-meta-item-text">WordCount:</span>
           <span class="post-count">444字</span>
           
         </span>
    
      <span class="post-time">
     &nbsp; | &nbsp;
           <span class="post-meta-item-icon">
             <i class="fa fa-clock-o"></i>
           </span>
           <span class="post-meta-item-text">min2read:</span>
           <span class="post-count">2分钟</span>
           
         </span>



        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <link rel="stylesheet" type="text/css" href="/assets/css/DPlayer.min.css"><script src="/assets/js/DPlayer.min.js"> </script><script src="/assets/js/APlayer.min.js"> </script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><hr>
<p>修改文章默认模板  hexo/scaffolds/post.md</p>
<p>博客中使用到的插件包 hexo/package.json。哎，这个文件里居然不能写注释，像下面这样一写就报错。。。</p>
<p>可使用 <code>npm ls --depth 0</code> 来排查</p>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="string">"name"</span>: <span class="string">"hexo-site"</span>,</div><div class="line">  <span class="string">"version"</span>: <span class="string">"0.0.0"</span>,</div><div class="line">  <span class="string">"private"</span>: <span class="literal">true</span>,</div><div class="line">  <span class="string">"hexo"</span>: &#123;</div><div class="line">    <span class="string">"version"</span>: <span class="string">"3.3.7"</span></div><div class="line">  &#125;,</div><div class="line">  <span class="string">"dependencies"</span>: &#123;</div><div class="line">    <span class="string">"hexo"</span>: <span class="string">"^3.2.0"</span>,</div><div class="line">    <span class="string">"hexo-admin"</span>: <span class="string">"^2.2.1"</span>, <span class="comment">//简单后台管理</span></div><div class="line">    <span class="string">"hexo-algolia"</span>: <span class="string">"^1.1.0"</span>, <span class="comment">// algolia搜索</span></div><div class="line">    <span class="string">"hexo-deployer-git"</span>: <span class="string">"^0.3.0"</span>,  <span class="comment">//git部署</span></div><div class="line">    <span class="string">"hexo-deployer-rsync"</span>: <span class="string">"^0.1.3"</span>,  <span class="comment">// 远程同步上传</span></div><div class="line">    <span class="string">"hexo-fs"</span>: <span class="string">"^0.2.1"</span>,    <span class="comment">//文件相关，去除为函数未调用警告</span></div><div class="line">    <span class="string">"hexo-generator-archive"</span>: <span class="string">"^0.1.4"</span>,   <span class="comment">//文章归档</span></div><div class="line">    <span class="string">"hexo-generator-baidu-sitemap"</span>: <span class="string">"^0.1.2"</span>, <span class="comment">//百度站点地图</span></div><div class="line">    <span class="string">"hexo-generator-category"</span>: <span class="string">"^0.1.3"</span>,  <span class="comment">//文章分类</span></div><div class="line">    <span class="string">"hexo-generator-feed"</span>: <span class="string">"^1.2.0"</span>,    <span class="comment">//RSS订阅</span></div><div class="line">    <span class="string">"hexo-generator-index"</span>: <span class="string">"^0.2.1"</span>,   <span class="comment">//首页配置</span></div><div class="line">    <span class="string">"hexo-generator-searchdb"</span>: <span class="string">"^1.0.7"</span>,  <span class="comment">//本地搜索</span></div><div class="line">    <span class="string">"hexo-generator-sitemap"</span>: <span class="string">"^1.2.0"</span>, <span class="comment">//谷歌站点地图</span></div><div class="line">    <span class="string">"hexo-generator-tag"</span>: <span class="string">"^0.2.0"</span>,   <span class="comment">//生成文章页面</span></div><div class="line">    <span class="string">"hexo-helper-post-top"</span>: <span class="string">"0.0.1"</span>, <span class="comment">// 文章置顶</span></div><div class="line">    <span class="string">"hexo-reference"</span>: <span class="string">"^1.0.3"</span>,  <span class="comment">//添加注脚</span></div><div class="line">    <span class="string">"hexo-renderer-ejs"</span>: <span class="string">"^0.2.0"</span>,</div><div class="line">    <span class="string">"hexo-renderer-marked"</span>: <span class="string">"^0.2.10"</span>,</div><div class="line">    <span class="string">"hexo-renderer-stylus"</span>: <span class="string">"^0.3.1"</span>,</div><div class="line">    <span class="string">"hexo-server"</span>: <span class="string">"^0.2.0"</span>,        <span class="comment">//本地预览</span></div><div class="line">    <span class="string">"hexo-tag-aplayer"</span>: <span class="string">"^2.0.1"</span>,   <span class="comment">//插入音乐</span></div><div class="line">    <span class="string">"hexo-tag-dplayer"</span>: <span class="string">"^0.1.7"</span>, <span class="comment">//插入视频</span></div><div class="line">    <span class="string">"hexo-wordcount"</span>: <span class="string">"^3.0.2"</span>   <span class="comment">//统计字数</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p> 每次写完新文章，发布都需要执行下面几步：</p>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">hexo -c  <span class="string">//</span> clean 清除缓存</div><div class="line">hexo -d	 <span class="string">//</span> <span class="keyword">deploy</span> 远程部署</div><div class="line">hexo -g  <span class="string">//</span> generator 生成页面</div></pre></td></tr></table></figure>
<p> 即使综合起来一条命令</p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hexo clean <span class="meta">&amp;&amp; hexo d -g</span></div></pre></td></tr></table></figure>
<p>感觉这样还是太繁琐了点，还想z再简化一下，咋办——使用<code>alias</code>取个简单别名</p>
<p> 打开或创建文件：<code>vi ~/.bash.profile</code></p>
<p>写入：<code>alias &#39;hexo-cdg&#39;=&#39;hexo clean &amp;&amp; hexo d -g&#39;</code></p>
<p>重新加载： <code>source  ~/.bash.profile</code></p>
<p>下次发布新文章就直接在hexo目录下执行 <code>hexo-cdg</code></p>
<p>Ubuntu下的 <code>alias</code></p>
<p>系统别名</p>
<p><code>usr/share/base-files/.bash_aliases</code></p>

          
        
      
    </div>

<div style="text-align:center;color: #ccc;font-size:14px;">—————————————— The End ——————————————</div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>





    
      

  

  
  
  



  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://tisfeng.com/2017/07/29/hexo成功迁移到自由域名/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tisfeng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/You729.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="今宵别梦寒">
    </span>


    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/29/hexo成功迁移到自由域名/" itemprop="url">hexo成功迁移到自由域名</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-29T10:46:00+08:00">
                2017-07-29
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/code/" itemprop="url" rel="index">
                    <span itemprop="name">code</span>
                  </a>
                </span>

                
                
              
            </span>
          


 <!-- 在下面的位置加上如下代码 -->


 <!-- 在上面的位置加上如上代码 -->

  
          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/07/29/hexo成功迁移到自由域名/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/07/29/hexo成功迁移到自由域名/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          



         
    

         <span class="post-time">
     &nbsp; | &nbsp;
           <span class="post-meta-item-icon">
             <i class="fa fa-file-word-o"></i>
           </span>
           <span class="post-meta-item-text">WordCount:</span>
           <span class="post-count">8字</span>
           
         </span>
    
      <span class="post-time">
     &nbsp; | &nbsp;
           <span class="post-meta-item-icon">
             <i class="fa fa-clock-o"></i>
           </span>
           <span class="post-meta-item-text">min2read:</span>
           <span class="post-count">1分钟</span>
           
         </span>



        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <link rel="stylesheet" type="text/css" href="/assets/css/DPlayer.min.css"><script src="/assets/js/DPlayer.min.js"> </script><script src="/assets/js/APlayer.min.js"> </script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>在搞HTTPS证书，，坑好多。。。</p>

          
        
      
    </div>

<div style="text-align:center;color: #ccc;font-size:14px;">—————————————— The End ——————————————</div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>





    
      

  

  
  
  



  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://tisfeng.com/2017/07/28/new-test/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tisfeng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/You729.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="今宵别梦寒">
    </span>


    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/28/new-test/" itemprop="url">hexo搬迁到自由域名</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-28T05:19:41+08:00">
                2017-07-28
              </time>
            

            

            
          </span>

          


 <!-- 在下面的位置加上如下代码 -->


 <!-- 在上面的位置加上如上代码 -->

  
          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/07/28/new-test/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/07/28/new-test/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          



         
    

         <span class="post-time">
     &nbsp; | &nbsp;
           <span class="post-meta-item-icon">
             <i class="fa fa-file-word-o"></i>
           </span>
           <span class="post-meta-item-text">WordCount:</span>
           <span class="post-count">11字</span>
           
         </span>
    
      <span class="post-time">
     &nbsp; | &nbsp;
           <span class="post-meta-item-icon">
             <i class="fa fa-clock-o"></i>
           </span>
           <span class="post-meta-item-text">min2read:</span>
           <span class="post-count">1分钟</span>
           
         </span>



        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <link rel="stylesheet" type="text/css" href="/assets/css/DPlayer.min.css"><script src="/assets/js/DPlayer.min.js"> </script><script src="/assets/js/APlayer.min.js"> </script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>测试，hexo搬迁到自有域名</p>
<p>test …..</p>
<p><a href="https://img.icos8.cc/image/B7p7" target="_blank" rel="external"><img src="https://img.icos8.cc/images/2017/07/29/Leaf_leave11.md.jpg" alt="Leaf_leave11.md.jpg"></a></p>

          
        
      
    </div>

<div style="text-align:center;color: #ccc;font-size:14px;">—————————————— The End ——————————————</div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>





    
      

  

  
  
  



  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://tisfeng.com/2017/07/24/markdown-test/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tisfeng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/You729.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="今宵别梦寒">
    </span>


    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/24/markdown-test/" itemprop="url">markdown test</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-24T01:46:16+08:00">
                2017-07-24
              </time>
            

            

            
          </span>

          


 <!-- 在下面的位置加上如下代码 -->


 <!-- 在上面的位置加上如上代码 -->

  
          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/07/24/markdown-test/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/07/24/markdown-test/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          



         
    

         <span class="post-time">
     &nbsp; | &nbsp;
           <span class="post-meta-item-icon">
             <i class="fa fa-file-word-o"></i>
           </span>
           <span class="post-meta-item-text">WordCount:</span>
           <span class="post-count">38字</span>
           
         </span>
    
      <span class="post-time">
     &nbsp; | &nbsp;
           <span class="post-meta-item-icon">
             <i class="fa fa-clock-o"></i>
           </span>
           <span class="post-meta-item-text">min2read:</span>
           <span class="post-count">1分钟</span>
           
         </span>



        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <link rel="stylesheet" type="text/css" href="/assets/css/DPlayer.min.css"><script src="/assets/js/DPlayer.min.js"> </script><script src="/assets/js/APlayer.min.js"> </script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="title1"><a href="#title1" class="headerlink" title="title1"></a>title1</h1><h2 id="title2"><a href="#title2" class="headerlink" title="title2"></a>title2</h2><h3 id="title3"><a href="#title3" class="headerlink" title="title3"></a>title3</h3><blockquote>
<p>sdfdfdfdfdf</p>
<p>dfdfdf</p>
<blockquote>
<p>dddd</p>
<blockquote>
<p>fffff</p>
<p><em>wang</em></p>
</blockquote>
</blockquote>
</blockquote>
<ul>
<li>first</li>
<li>two</li>
<li>three</li>
</ul>
<ol>
<li>wang</li>
<li>xun</li>
<li>feng</li>
</ol>
<p><em>wangxunfeng</em></p>
<p><strong>wangxunfeng</strong></p>
<p><strong>wang</strong></p>
 <figure class="highlight ebnf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">wang</span></div><div class="line">xun</div><div class="line">feng</div></pre></td></tr></table></figure>
<hr>
<p>this is <a href="http://wowubuntu.com/markdown/" title="markdown yf" target="_blank" rel="external">mk</a></p>
<p><code>wangddfdfdfdffdf</code></p>
<pre><code>### link:
</code></pre><p><code>&lt;https://google.com&gt;</code></p>
<p><a href="https://google.com" target="_blank" rel="external">https://google.com</a></p>
<p><code>[google](https://google.com)</code></p>
<p><a href="https://google.com" title="go" target="_blank" rel="external">google</a></p>

          
        
      
    </div>

<div style="text-align:center;color: #ccc;font-size:14px;">—————————————— The End ——————————————</div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>





    
      

  

  
  
  



  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://tisfeng.com/2017/07/19/test2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tisfeng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/You729.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="今宵别梦寒">
    </span>


    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/19/test2/" itemprop="url">逃离</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-19T04:23:02+08:00">
                2017-07-19
              </time>
            

            

            
          </span>

          


 <!-- 在下面的位置加上如下代码 -->


 <!-- 在上面的位置加上如上代码 -->

  
          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/07/19/test2/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/07/19/test2/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          



         
    

         <span class="post-time">
     &nbsp; | &nbsp;
           <span class="post-meta-item-icon">
             <i class="fa fa-file-word-o"></i>
           </span>
           <span class="post-meta-item-text">WordCount:</span>
           <span class="post-count">2,980字</span>
           
         </span>
    
      <span class="post-time">
     &nbsp; | &nbsp;
           <span class="post-meta-item-icon">
             <i class="fa fa-clock-o"></i>
           </span>
           <span class="post-meta-item-text">min2read:</span>
           <span class="post-count">15分钟</span>
           
         </span>



        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <link rel="stylesheet" type="text/css" href="/assets/css/DPlayer.min.css"><script src="/assets/js/DPlayer.min.js"> </script><script src="/assets/js/APlayer.min.js"> </script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>我希望能够远走，逃离我的所知，逃离我的所有。我想出发，去任何地方，不论是村庄或者荒原，只要不是这里就行。我向往的只是不再见到这些人，不再过这种没完没了的日子。我想做到的，是卸下我已习惯的伪装，成为另一个我，以此得到喘息。不幸的是，我在这些事情上从来都事与愿违。</p>
<p>——佩索阿《惶然录》</p>
<hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div><div class="line">340</div><div class="line">341</div><div class="line">342</div><div class="line">343</div><div class="line">344</div><div class="line">345</div><div class="line">346</div><div class="line">347</div><div class="line">348</div><div class="line">349</div><div class="line">350</div><div class="line">351</div><div class="line">352</div><div class="line">353</div><div class="line">354</div><div class="line">355</div><div class="line">356</div><div class="line">357</div><div class="line">358</div><div class="line">359</div><div class="line">360</div><div class="line">361</div><div class="line">362</div><div class="line">363</div><div class="line">364</div><div class="line">365</div><div class="line">366</div><div class="line">367</div><div class="line">368</div><div class="line">369</div><div class="line">370</div><div class="line">371</div><div class="line">372</div><div class="line">373</div><div class="line">374</div><div class="line">375</div><div class="line">376</div><div class="line">377</div><div class="line">378</div><div class="line">379</div><div class="line">380</div><div class="line">381</div><div class="line">382</div><div class="line">383</div><div class="line">384</div><div class="line">385</div><div class="line">386</div><div class="line">387</div><div class="line">388</div><div class="line">389</div><div class="line">390</div><div class="line">391</div><div class="line">392</div><div class="line">393</div><div class="line">394</div><div class="line">395</div><div class="line">396</div><div class="line">397</div><div class="line">398</div><div class="line">399</div><div class="line">400</div><div class="line">401</div><div class="line">402</div><div class="line">403</div><div class="line">404</div><div class="line">405</div><div class="line">406</div><div class="line">407</div><div class="line">408</div><div class="line">409</div><div class="line">410</div><div class="line">411</div><div class="line">412</div><div class="line">413</div><div class="line">414</div><div class="line">415</div><div class="line">416</div><div class="line">417</div><div class="line">418</div><div class="line">419</div><div class="line">420</div><div class="line">421</div><div class="line">422</div><div class="line">423</div><div class="line">424</div><div class="line">425</div><div class="line">426</div><div class="line">427</div><div class="line">428</div><div class="line">429</div><div class="line">430</div><div class="line">431</div><div class="line">432</div><div class="line">433</div><div class="line">434</div><div class="line">435</div><div class="line">436</div><div class="line">437</div><div class="line">438</div><div class="line">439</div><div class="line">440</div><div class="line">441</div><div class="line">442</div><div class="line">443</div><div class="line">444</div><div class="line">445</div><div class="line">446</div><div class="line">447</div><div class="line">448</div><div class="line">449</div><div class="line">450</div><div class="line">451</div><div class="line">452</div><div class="line">453</div><div class="line">454</div><div class="line">455</div><div class="line">456</div><div class="line">457</div><div class="line">458</div><div class="line">459</div><div class="line">460</div><div class="line">461</div><div class="line">462</div><div class="line">463</div><div class="line">464</div><div class="line">465</div><div class="line">466</div><div class="line">467</div><div class="line">468</div><div class="line">469</div><div class="line">470</div><div class="line">471</div><div class="line">472</div><div class="line">473</div><div class="line">474</div><div class="line">475</div><div class="line">476</div><div class="line">477</div><div class="line">478</div><div class="line">479</div><div class="line">480</div><div class="line">481</div><div class="line">482</div><div class="line">483</div><div class="line">484</div><div class="line">485</div><div class="line">486</div><div class="line">487</div><div class="line">488</div><div class="line">489</div><div class="line">490</div><div class="line">491</div><div class="line">492</div><div class="line">493</div><div class="line">494</div><div class="line">495</div><div class="line">496</div><div class="line">497</div><div class="line">498</div><div class="line">499</div><div class="line">500</div><div class="line">501</div><div class="line">502</div><div class="line">503</div><div class="line">504</div><div class="line">505</div><div class="line">506</div><div class="line">507</div><div class="line">508</div><div class="line">509</div><div class="line">510</div><div class="line">511</div><div class="line">512</div><div class="line">513</div><div class="line">514</div><div class="line">515</div><div class="line">516</div><div class="line">517</div><div class="line">518</div><div class="line">519</div><div class="line">520</div><div class="line">521</div><div class="line">522</div><div class="line">523</div><div class="line">524</div><div class="line">525</div><div class="line">526</div><div class="line">527</div><div class="line">528</div><div class="line">529</div><div class="line">530</div><div class="line">531</div><div class="line">532</div><div class="line">533</div><div class="line">534</div><div class="line">535</div><div class="line">536</div><div class="line">537</div><div class="line">538</div><div class="line">539</div><div class="line">540</div><div class="line">541</div><div class="line">542</div><div class="line">543</div><div class="line">544</div><div class="line">545</div><div class="line">546</div><div class="line">547</div><div class="line">548</div><div class="line">549</div><div class="line">550</div><div class="line">551</div><div class="line">552</div><div class="line">553</div><div class="line">554</div><div class="line">555</div><div class="line">556</div><div class="line">557</div><div class="line">558</div><div class="line">559</div><div class="line">560</div><div class="line">561</div><div class="line">562</div><div class="line">563</div><div class="line">564</div><div class="line">565</div><div class="line">566</div><div class="line">567</div><div class="line">568</div><div class="line">569</div><div class="line">570</div><div class="line">571</div><div class="line">572</div><div class="line">573</div><div class="line">574</div><div class="line">575</div><div class="line">576</div><div class="line">577</div><div class="line">578</div><div class="line">579</div><div class="line">580</div><div class="line">581</div><div class="line">582</div><div class="line">583</div><div class="line">584</div><div class="line">585</div><div class="line">586</div><div class="line">587</div><div class="line">588</div><div class="line">589</div><div class="line">590</div><div class="line">591</div><div class="line">592</div><div class="line">593</div><div class="line">594</div><div class="line">595</div><div class="line">596</div><div class="line">597</div><div class="line">598</div><div class="line">599</div><div class="line">600</div><div class="line">601</div><div class="line">602</div><div class="line">603</div><div class="line">604</div><div class="line">605</div><div class="line">606</div><div class="line">607</div><div class="line">608</div><div class="line">609</div><div class="line">610</div><div class="line">611</div><div class="line">612</div><div class="line">613</div><div class="line">614</div><div class="line">615</div><div class="line">616</div><div class="line">617</div><div class="line">618</div><div class="line">619</div><div class="line">620</div><div class="line">621</div><div class="line">622</div><div class="line">623</div><div class="line">624</div><div class="line">625</div><div class="line">626</div><div class="line">627</div><div class="line">628</div><div class="line">629</div><div class="line">630</div><div class="line">631</div><div class="line">632</div><div class="line">633</div><div class="line">634</div><div class="line">635</div><div class="line">636</div><div class="line">637</div><div class="line">638</div><div class="line">639</div><div class="line">640</div><div class="line">641</div><div class="line">642</div><div class="line">643</div><div class="line">644</div><div class="line">645</div><div class="line">646</div><div class="line">647</div><div class="line">648</div><div class="line">649</div><div class="line">650</div><div class="line">651</div><div class="line">652</div><div class="line">653</div><div class="line">654</div><div class="line">655</div><div class="line">656</div><div class="line">657</div><div class="line">658</div><div class="line">659</div><div class="line">660</div><div class="line">661</div><div class="line">662</div><div class="line">663</div><div class="line">664</div><div class="line">665</div><div class="line">666</div><div class="line">667</div><div class="line">668</div><div class="line">669</div><div class="line">670</div><div class="line">671</div><div class="line">672</div><div class="line">673</div><div class="line">674</div><div class="line">675</div><div class="line">676</div><div class="line">677</div><div class="line">678</div><div class="line">679</div><div class="line">680</div><div class="line">681</div><div class="line">682</div><div class="line">683</div><div class="line">684</div><div class="line">685</div><div class="line">686</div><div class="line">687</div><div class="line">688</div><div class="line">689</div><div class="line">690</div><div class="line">691</div></pre></td><td class="code"><pre><div class="line">//</div><div class="line">//  AppDelegate.m</div><div class="line">//  DDULearn</div><div class="line">//</div><div class="line">//  Created by hxed on 2017/2/16.</div><div class="line">//  Copyright © 2017年 WangXunfeng. All rights reserved.</div><div class="line">//</div><div class="line"></div><div class="line">#import &quot;AppDelegate.h&quot;</div><div class="line"></div><div class="line">#import &lt;AMapFoundationKit/AMapFoundationKit.h&gt;</div><div class="line">#import &lt;RongIMKit/RongIMKit.h&gt;</div><div class="line">#import &quot;IQKeyboardManager.h&quot;</div><div class="line">#import &quot;MMDrawerController.h&quot;</div><div class="line"></div><div class="line">#import &quot;UXMainViewController.h&quot;</div><div class="line">#import &quot;UXiCenterVC.h&quot;</div><div class="line">#import &quot;UXRightVC.h&quot;</div><div class="line">#import &quot;SDWebImageManager.h&quot;</div><div class="line">#import &quot;UXTestChatViewController.h&quot;</div><div class="line"></div><div class="line">#ifdef NSFoundationVersionNumber_iOS_9_x_Max</div><div class="line">#import &lt;UserNotifications/UserNotifications.h&gt;</div><div class="line">#endif</div><div class="line"></div><div class="line">// 引入JPush功能所需头文件</div><div class="line">#import &quot;JPUSHService.h&quot;</div><div class="line">// iOS10注册APNs所需头文件</div><div class="line">#ifdef NSFoundationVersionNumber_iOS_9_x_Max</div><div class="line">#import &lt;UserNotifications/UserNotifications.h&gt;</div><div class="line">#endif</div><div class="line">// 如果需要使用idfa功能所需要引入的头文件（可选）</div><div class="line">#import &lt;AdSupport/AdSupport.h&gt;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">//  融云SDK</div><div class="line">static NSString * const RongYun_Key = @&quot;6tnym1br6ggu7&quot;;</div><div class="line">static NSString * const RongYun_Secret = @&quot;0KD08XfVd4c&quot;;</div><div class="line"></div><div class="line">//  高德SDK</div><div class="line">static NSString * const GaoDeMap_Key = @&quot;93d41a79fc16d0547e4aab4b666f4ef7&quot;;</div><div class="line"></div><div class="line">//  Jpush</div><div class="line">static NSString * const Jpush_Key = @&quot;fc769e9cabf9c93cd934f357&quot;;</div><div class="line"></div><div class="line">NSString * RongYun_Token = @&quot;oxVWw30bJDVDK6w86pzUjnpI92qiwflHGcNlXpMjR5OgQl65rAZZmJECboP7i7W4Rwsa8KU7gJU=&quot;;</div><div class="line">//static NSString * const RongYun_Key = @&quot;6tnym1br6ggu7&quot;;</div><div class="line">//static NSString * const RongYun_Secret = @&quot;0KD08XfVd4c&quot;;</div><div class="line"></div><div class="line"></div><div class="line">#pragma mark 自己申请</div><div class="line">//static NSString * const RongYun_Token = @&quot;yPCseovW+OFtWuCqY4p+z6VDl2pMzSpFrURFGlPagKIM+qjDZZ1RqM03OeQE1xmUdyk2oHaS7EgUxS0VDXU8LTm06Yzc6HA6&quot;;</div><div class="line">//static NSString * const RongYun_Key = @&quot;6tnym1br6gbv7&quot;;</div><div class="line"></div><div class="line">//static NSString * const GaoDeMap_Key = @&quot;93d41a79fc16d0547e4aab4b666f4ef7&quot;;</div><div class="line"></div><div class="line"></div><div class="line">@interface AppDelegate () &lt;RCIMUserInfoDataSource, RCIMReceiveMessageDelegate, UNUserNotificationCenterDelegate, JPUSHRegisterDelegate&gt;</div><div class="line">&#123;</div><div class="line">    UIView * _navBackView;</div><div class="line">&#125;</div><div class="line"></div><div class="line">@property(nonatomic,strong) MMDrawerController * drawerController;</div><div class="line"></div><div class="line">@end</div><div class="line"></div><div class="line">@implementation AppDelegate</div><div class="line"></div><div class="line"></div><div class="line">- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions &#123;</div><div class="line">    </div><div class="line">    [self setRootViewController];</div><div class="line">    [self setNavBar];</div><div class="line">    [self configSDK];</div><div class="line">    </div><div class="line">    [self registerLogin];</div><div class="line">    </div><div class="line">    </div><div class="line">    [self registerNotificationOnApplication:application];</div><div class="line">    </div><div class="line">    // JPush 推送</div><div class="line">    </div><div class="line">    JPUSHRegisterEntity * entity = [[JPUSHRegisterEntity alloc] init];</div><div class="line">    entity.types = JPAuthorizationOptionAlert|JPAuthorizationOptionBadge|JPAuthorizationOptionSound;</div><div class="line">    if ([[UIDevice currentDevice].systemVersion floatValue] &gt;= 8.0) &#123;</div><div class="line">        </div><div class="line">        // 可以添加自定义categories</div><div class="line">        // NSSet&lt;UNNotificationCategory *&gt; *categories for iOS10 or later</div><div class="line">        // NSSet&lt;UIUserNotificationCategory *&gt; *categories for iOS8 and iOS9</div><div class="line">        </div><div class="line">        [[UNUserNotificationCenter currentNotificationCenter] setNotificationCategories:[self createNotificationCategoryActions]];</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    [JPUSHService registerForRemoteNotificationConfig:entity delegate:self];</div><div class="line">    </div><div class="line">    </div><div class="line">    // Optional</div><div class="line">    // 获取IDFA</div><div class="line">    // 如需使用IDFA功能请添加此代码并在初始化方法的advertisingIdentifier参数中填写对应值</div><div class="line">    NSString *advertisingId = [[[ASIdentifierManager sharedManager] advertisingIdentifier] UUIDString];</div><div class="line">    </div><div class="line">    // Required</div><div class="line">    // init Push</div><div class="line">    // notice: 2.1.5版本的SDK新增的注册方法，改成可上报IDFA，如果没有使用IDFA直接传nil</div><div class="line">    // 如需继续使用pushConfig.plist文件声明appKey等配置内容，请依旧使用[JPUSHService setupWithOption:launchOptions]方式初始化。</div><div class="line">    [JPUSHService setupWithOption:launchOptions appKey:Jpush_Key</div><div class="line">                          channel:nil</div><div class="line">                 apsForProduction:NO</div><div class="line">            advertisingIdentifier:advertisingId];</div><div class="line">    </div><div class="line">    return YES;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)test &#123;</div><div class="line">    </div><div class="line">    [self configRongYunSDK];</div><div class="line">    </div><div class="line">    self.window.rootViewController = [[UINavigationController alloc] initWithRootViewController:[UXTestChatViewController new]];</div><div class="line">    </div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)setRootViewController &#123;</div><div class="line">    </div><div class="line">    UINavigationController * mainNav = [[UINavigationController alloc] initWithRootViewController:[UXMainViewController new]];</div><div class="line">    </div><div class="line">    UIView * statuesBar = [[UIView alloc] initWithFrame:CGRectMake(0, -20, WFKScreenWidth, 20)];</div><div class="line">    statuesBar.backgroundColor = [UIColor whiteColor];</div><div class="line">    </div><div class="line">    </div><div class="line">    UINavigationController * leftNav = [[UINavigationController alloc] initWithRootViewController:[[UXiCenterVC alloc] init]];</div><div class="line">    </div><div class="line">    //    UINavigationController * rightNav = [[UINavigationController alloc] initWithRootViewController:[WFTestVC new]];</div><div class="line">    </div><div class="line">    </div><div class="line">    //    [leftNav.navigationBar addSubview:statuesBar];</div><div class="line">    </div><div class="line">    self.drawerController = [[MMDrawerController alloc] initWithCenterViewController:mainNav leftDrawerViewController:leftNav rightDrawerViewController:nil];</div><div class="line">    </div><div class="line">    self.drawerController.maximumLeftDrawerWidth = WFKScreenWidth*0.6;</div><div class="line">    </div><div class="line">    //4、设置打开/关闭抽屉的手势</div><div class="line">    self.drawerController.openDrawerGestureModeMask = MMOpenDrawerGestureModeAll;</div><div class="line">    self.drawerController.closeDrawerGestureModeMask =MMCloseDrawerGestureModeAll;</div><div class="line">    </div><div class="line">    self.navigationVC = mainNav;</div><div class="line">    </div><div class="line">    self.window = [[UIWindow alloc]initWithFrame:[UIScreen mainScreen].bounds];</div><div class="line">    [self.window setRootViewController:self.drawerController];</div><div class="line">    [self.window makeKeyAndVisible];</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">/**</div><div class="line"> 设置导航栏</div><div class="line"> */</div><div class="line">- (void)setNavBar &#123;</div><div class="line">    </div><div class="line">    //    设置左右按钮的颜色</div><div class="line">    [[UINavigationBar appearance] setTintColor:[UIColor blackColor]];</div><div class="line">    //    修改导航条的背景色</div><div class="line">    [[UINavigationBar appearance] setBarTintColor:[UIColor whiteColor]];</div><div class="line">    </div><div class="line">    [UINavigationBar appearance].backgroundColor = [UIColor whiteColor];</div><div class="line">    //    [[UINavigationBar appearance] setBackgroundImage:[UIImage imageNamed:@&quot;navbar_bg_image&quot;] forBarMetrics:UIBarMetricsDefault];</div><div class="line">    [[UINavigationBar appearance] setShadowImage:[[UIImage alloc] init]];</div><div class="line">    </div><div class="line">    NSDictionary * attributesDic = @&#123;NSForegroundColorAttributeName:[UIColor blackColor],</div><div class="line">                                     NSFontAttributeName:[UIFont systemFontOfSize:16]</div><div class="line">                                     &#125;;</div><div class="line">    //    修改中间title的属性</div><div class="line">    [[UINavigationBar appearance] setTitleTextAttributes:attributesDic];</div><div class="line">    </div><div class="line">    [[UINavigationBar appearance] setBarStyle:UIBarStyleDefault];</div><div class="line">    //    设置状态栏样式</div><div class="line">    [UIApplication sharedApplication].statusBarStyle = UIStatusBarStyleDefault;</div><div class="line">    </div><div class="line">    //    self.navigationController.navigationBar.barStyle = UIBarStyleBlack;</div><div class="line">    </div><div class="line">    </div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)configSDK &#123;</div><div class="line">    </div><div class="line">    //    自动适应弹出键盘</div><div class="line">    [[IQKeyboardManager sharedManager] setCanAdjustTextView:YES];</div><div class="line">    [[IQKeyboardManager sharedManager] setShouldResignOnTouchOutside:YES];</div><div class="line">    </div><div class="line">    //    高德地图 SDK</div><div class="line">    [AMapServices sharedServices].apiKey = GaoDeMap_Key;</div><div class="line">    </div><div class="line">    //    配置融云SDK</div><div class="line">    //    [self configRongYunSDK];</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">//    配置融云SDK</div><div class="line">- (void)configRongYunSDK</div><div class="line">&#123;</div><div class="line">    UXUserInfo * user = [NSKeyedUnarchiver unarchiveObjectWithFile:KUserFile];</div><div class="line">    </div><div class="line">    NSLog(@&quot;user: %@&quot;,user);</div><div class="line">    [RCIM sharedRCIM].portraitImageViewCornerRadius = 0;</div><div class="line">    [[RCIM sharedRCIM] initWithAppKey:RongYun_Key];</div><div class="line">    </div><div class="line">    if (!user.cloudToken) &#123;</div><div class="line">        </div><div class="line">        user.cloudToken = RongYun_Token;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    NSLog(@&quot;token: %@&quot;,user.cloudToken);</div><div class="line">    </div><div class="line">    [[RCIM sharedRCIM] disconnect:YES];</div><div class="line">    [[RCIM sharedRCIM] setEnableMessageAttachUserInfo:YES];</div><div class="line">    </div><div class="line">    </div><div class="line">    [[RCIM sharedRCIM] connectWithToken:user.cloudToken success:^(NSString *userId) &#123;</div><div class="line">        </div><div class="line">        [[RCIM sharedRCIM] setEnableMessageRecall:YES];</div><div class="line">        </div><div class="line">        [[RCIM sharedRCIM] setReceiveMessageDelegate:self];</div><div class="line">        [[RCIM sharedRCIM] setUserInfoDataSource:self];</div><div class="line">        </div><div class="line">        RCUserInfo * userInfo = [[RCUserInfo alloc] init];</div><div class="line">        userInfo.userId = userId;</div><div class="line">        userInfo.name = user.nickName;</div><div class="line">        userInfo.portraitUri = user.headImg;</div><div class="line">        </div><div class="line">        [[RCIM sharedRCIM] setCurrentUserInfo:userInfo];</div><div class="line">        </div><div class="line">        </div><div class="line">        NSLog(@&quot;登陆成功。当前登录的用户ID：%@&quot;, userId);</div><div class="line">        </div><div class="line">    &#125; error:^(RCConnectErrorCode status) &#123;</div><div class="line">        NSLog(@&quot;登陆的错误码为:%ld&quot;, (long)status);</div><div class="line">    &#125; tokenIncorrect:^&#123;</div><div class="line">        //token过期或者不正确。</div><div class="line">        //如果设置了token有效期并且token过期，请重新请求您的服务器获取新的token</div><div class="line">        //如果没有设置token有效期却提示token错误，请检查您客户端和服务器的appkey是否匹配，还有检查您获取token的流程。</div><div class="line">        NSLog(@&quot;token错误&quot;);</div><div class="line">    &#125;];</div><div class="line">    </div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)registerNotificationOnApplication:(UIApplication *)application &#123;</div><div class="line">    </div><div class="line">    if ([[UIDevice currentDevice].systemVersion floatValue] &gt;= 10.0) &#123;</div><div class="line">        //iOS10特有</div><div class="line">        UNUserNotificationCenter *center = [UNUserNotificationCenter currentNotificationCenter];</div><div class="line">        // 必须写代理，不然无法监听通知的接收与点击</div><div class="line">        center.delegate = self;</div><div class="line">        [center requestAuthorizationWithOptions:(UNAuthorizationOptionAlert | UNAuthorizationOptionBadge | UNAuthorizationOptionSound) completionHandler:^(BOOL granted, NSError * _Nullable error) &#123;</div><div class="line">            if (granted) &#123;</div><div class="line">                // 点击允许通知</div><div class="line">                NSLog(@&quot;注册成功&quot;);</div><div class="line">                [center getNotificationSettingsWithCompletionHandler:^(UNNotificationSettings * _Nonnull settings) &#123;</div><div class="line">                    </div><div class="line">                    NSLog(@&quot;%@&quot;, settings);</div><div class="line">                &#125;];</div><div class="line">                </div><div class="line">            &#125; else &#123;</div><div class="line">                // 点击不允许</div><div class="line">                NSLog(@&quot;注册失败&quot;);</div><div class="line">            &#125;</div><div class="line">        &#125;];</div><div class="line">        </div><div class="line">    &#125; else if ([[UIDevice currentDevice].systemVersion floatValue] &gt;8.0) &#123;</div><div class="line">        //iOS8 - iOS10</div><div class="line">        [application registerUserNotificationSettings:[UIUserNotificationSettings settingsForTypes:UIUserNotificationTypeAlert | UIUserNotificationTypeSound | UIUserNotificationTypeBadge categories:nil]];</div><div class="line">        </div><div class="line">    &#125; else if ([[UIDevice currentDevice].systemVersion floatValue] &lt; 8.0) &#123;</div><div class="line">        //iOS8系统以下</div><div class="line">        [application registerForRemoteNotificationTypes:UIRemoteNotificationTypeBadge | UIRemoteNotificationTypeAlert | UIRemoteNotificationTypeSound];</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">    [self timeNotificationTest];</div><div class="line">    </div><div class="line">    // 注册获得device Token</div><div class="line">    [[UIApplication sharedApplication] registerForRemoteNotifications];</div><div class="line">&#125;</div><div class="line"></div><div class="line">//  测试本地时间通知</div><div class="line">- (void)timeNotificationTest &#123;</div><div class="line">    </div><div class="line">    // 1、创建通知内容，注：这里得用可变类型的UNMutableNotificationContent，否则内容的属性是只读的</div><div class="line">    UNMutableNotificationContent *content = [[UNMutableNotificationContent alloc] init];</div><div class="line">    // 标题</div><div class="line">    content.title = @&quot;柯梵通知&quot;;</div><div class="line">    // 次标题</div><div class="line">    content.subtitle = @&quot;柯梵办公室通知&quot;;</div><div class="line">    // 内容</div><div class="line">    content.body = @&quot;柯梵科技是一家以人为本，具有强烈社会责任感的公司。公司的最大愿景就是每个员工都能住上大房子，开上好车，实现逆袭高富帅、白富美的愿望。&quot;;</div><div class="line">    </div><div class="line">    //                self.badge++;</div><div class="line">    // app显示通知数量的角标</div><div class="line">    content.badge = @(9);</div><div class="line">    </div><div class="line">    // 通知的提示声音，这里用的默认的声音</div><div class="line">    content.sound = [UNNotificationSound defaultSound];</div><div class="line">    </div><div class="line">    NSURL *imageUrl = [[NSBundle mainBundle] URLForResource:@&quot;Leaf&quot; withExtension:@&quot;jpg&quot;];</div><div class="line">    </div><div class="line">    imageUrl = [NSURL fileURLWithPath:[[NSBundle mainBundle] pathForResource:@&quot;Leaf.jpg&quot; ofType:nil]];</div><div class="line">    </div><div class="line">    UNNotificationAttachment *attachment = [UNNotificationAttachment attachmentWithIdentifier:@&quot;imageIndetifier&quot; URL:imageUrl options:nil error:nil];</div><div class="line">    </div><div class="line">    // 附件 可以是音频、图片、视频 这里是一张图片</div><div class="line">    content.attachments = @[attachment];</div><div class="line">    </div><div class="line">    // 标识符</div><div class="line">    content.categoryIdentifier = @&quot;categoryIndentifier&quot;;</div><div class="line">    </div><div class="line">    </div><div class="line">    // 2、创建通知触发</div><div class="line">    /* 触发器分三种：</div><div class="line">     UNTimeIntervalNotificationTrigger : 在一定时间后触发，如果设置重复的话，timeInterval不能小于60</div><div class="line">     UNCalendarNotificationTrigger : 在某天某时触发，可重复</div><div class="line">     UNLocationNotificationTrigger : 进入或离开某个地理区域时触发</div><div class="line">     */</div><div class="line">    UNTimeIntervalNotificationTrigger *trigger = [UNTimeIntervalNotificationTrigger triggerWithTimeInterval:7 repeats:NO];</div><div class="line">    </div><div class="line">    //在每周一的16点3分提醒</div><div class="line">    NSDateComponents *components = [[NSDateComponents alloc] init];</div><div class="line">    components.weekday = 2;</div><div class="line">    components.hour = 16;</div><div class="line">    components.minute = 3;</div><div class="line">    // components 日期</div><div class="line">    UNCalendarNotificationTrigger *calendarTrigger = [UNCalendarNotificationTrigger triggerWithDateMatchingComponents:components repeats:YES];</div><div class="line">    </div><div class="line">    </div><div class="line">    [[UNUserNotificationCenter currentNotificationCenter] setNotificationCategories:[self createNotificationCategoryActions]];</div><div class="line">    </div><div class="line">    // 3、创建通知请求</div><div class="line">    UNNotificationRequest *notificationRequest = [UNNotificationRequest requestWithIdentifier:@&quot;KFGroupNotification&quot; content:content trigger:trigger];</div><div class="line">    </div><div class="line">    // 4、将请求加入通知中心</div><div class="line">    [[UNUserNotificationCenter currentNotificationCenter] addNotificationRequest:notificationRequest withCompletionHandler:^(NSError * _Nullable error) &#123;</div><div class="line">        if (error == nil) &#123;</div><div class="line">            NSLog(@&quot;已成功加推送：%@&quot;,notificationRequest.identifier);</div><div class="line">        &#125;</div><div class="line">    &#125;];</div><div class="line">&#125;</div><div class="line"></div><div class="line">// 获得Device Token</div><div class="line">- (void)application:(UIApplication *)application didRegisterForRemoteNotificationsWithDeviceToken:(NSData *)deviceToken &#123;</div><div class="line">    </div><div class="line">    /// Required - 注册 DeviceToken</div><div class="line">    [JPUSHService registerDeviceToken:deviceToken];</div><div class="line">    </div><div class="line">    </div><div class="line">    //     &lt;724e4406 f3c3e15b ee88587b e5c0db16 96c917d4 ab769fb5 b725e68f cc5700ca&gt;</div><div class="line">    NSLog(@&quot;%@&quot;, [NSString stringWithFormat:@&quot;Device Token: %@&quot;, deviceToken]);</div><div class="line">&#125;</div><div class="line">// 获得Device Token失败</div><div class="line">- (void)application:(UIApplication *)application</div><div class="line">didFailToRegisterForRemoteNotificationsWithError:(NSError *)error &#123;</div><div class="line">    </div><div class="line">    NSLog(@&quot;did Fail To Register For Remote Notifications With Error: %@&quot;, error);</div><div class="line">&#125;</div><div class="line"></div><div class="line">// iOS 10收到通知，如果在想应用内展示通知 （如果不想在应用内展示，可以不实现这个方法）</div><div class="line">- (void)userNotificationCenter:(UNUserNotificationCenter *)center willPresentNotification:(UNNotification *)notification withCompletionHandler:(void (^)(UNNotificationPresentationOptions options))completionHandler &#123;</div><div class="line">    </div><div class="line">    NSDictionary * userInfo = notification.request.content.userInfo;</div><div class="line">    UNNotificationRequest *request = notification.request; // 收到推送的请求</div><div class="line">    UNNotificationContent *content = request.content; // 收到推送的消息内容</div><div class="line">    NSNumber *badge = content.badge;  // 推送消息的角标</div><div class="line">    NSString *body = content.body;    // 推送消息体</div><div class="line">    UNNotificationSound *sound = content.sound;  // 推送消息的声音</div><div class="line">    NSString *subtitle = content.subtitle;  // 推送消息的副标题</div><div class="line">    NSString *title = content.title;  // 推送消息的标题</div><div class="line">    </div><div class="line">    if([notification.request.trigger isKindOfClass:[UNPushNotificationTrigger class]]) &#123;</div><div class="line">        NSLog(@&quot;iOS10 前台收到远程通知:%@&quot;, userInfo);</div><div class="line">    &#125;</div><div class="line">    else &#123;</div><div class="line">        // 判断为本地通知</div><div class="line">        NSLog(@&quot;iOS10 前台收到本地通知:&#123;\\\\nbody:%@，\\\\ntitle:%@,\\\\nsubtitle:%@,\\\\nbadge：%@，\\\\nsound：%@，\\\\nuserInfo：%@\\\\n&#125;&quot;,body,title,subtitle,badge,sound,userInfo);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    NSLog(@&quot;center: %@, current: %@&quot;,center,[UNUserNotificationCenter currentNotificationCenter]);</div><div class="line">    </div><div class="line">    [[UNUserNotificationCenter currentNotificationCenter] setNotificationCategories:[self createNotificationCategoryActions]];</div><div class="line">    </div><div class="line">    </div><div class="line">    // Required</div><div class="line">    if([notification.request.trigger isKindOfClass:[UNPushNotificationTrigger class]]) &#123;</div><div class="line">        [JPUSHService handleRemoteNotification:userInfo];</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    // 需要执行这个方法，选择是否提醒用户，有Badge、Sound、Alert三种类型可以设置</div><div class="line">    completionHandler(UNNotificationPresentationOptionBadge | UNNotificationPresentationOptionSound | UNNotificationPresentationOptionAlert);</div><div class="line">&#125;</div><div class="line">- (void)didReceiveNotification:(UNNotification *)notification &#123;</div><div class="line">    </div><div class="line">&#125;</div><div class="line">// 通知的点击事件</div><div class="line">- (void)userNotificationCenter:(UNUserNotificationCenter *)center didReceiveNotificationResponse:(UNNotificationResponse *)response withCompletionHandler:(void(^)())completionHandler &#123;</div><div class="line">    </div><div class="line">    NSDictionary * userInfo = response.notification.request.content.userInfo;</div><div class="line">    UNNotificationRequest *request = response.notification.request; // 收到推送的请求</div><div class="line">    UNNotificationContent *content = request.content; // 收到推送的消息内容</div><div class="line">    NSNumber *badge = content.badge;  // 推送消息的角标</div><div class="line">    NSString *body = content.body;    // 推送消息体</div><div class="line">    UNNotificationSound *sound = content.sound;  // 推送消息的声音</div><div class="line">    NSString *subtitle = content.subtitle;  // 推送消息的副标题</div><div class="line">    NSString *title = content.title;  // 推送消息的标题</div><div class="line">    </div><div class="line">    if ([response.actionIdentifier isEqualToString:@&quot;see1&quot;]) &#123;</div><div class="line">        //I love it~的处理</div><div class="line">        </div><div class="line">    &#125;</div><div class="line">    if ([response.actionIdentifier isEqualToString:@&quot;see2&quot;]) &#123;</div><div class="line">        //I don&apos;t care~</div><div class="line">        [[UNUserNotificationCenter currentNotificationCenter] removeDeliveredNotificationsWithIdentifiers:@[response.notification.request.identifier]];</div><div class="line">    &#125;</div><div class="line">    if ([response.actionIdentifier isEqualToString:@&quot;text&quot;]) &#123;</div><div class="line">        </div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    if([response.notification.request.trigger isKindOfClass:[UNPushNotificationTrigger class]]) &#123;</div><div class="line">        NSLog(@&quot;iOS10 收到远程通知:%@&quot;, userInfo);</div><div class="line">    &#125;</div><div class="line">    else &#123;</div><div class="line">        // 判断为本地通知</div><div class="line">        NSLog(@&quot;iOS10 收到本地通知:&#123;\\\\nbody:%@，\\\\ntitle:%@,\\\\nsubtitle:%@,\\\\nbadge：%@，\\\\nsound：%@，\\\\nuserInfo：%@\\\\n&#125;&quot;,body,title,subtitle,badge,sound,userInfo);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    // Required</div><div class="line">    if([response.notification.request.trigger isKindOfClass:[UNPushNotificationTrigger class]]) &#123;</div><div class="line">        [JPUSHService handleRemoteNotification:userInfo];</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    completionHandler();  // 系统要求执行这个方法 🍃</div><div class="line">    </div><div class="line">    //    http://www.cnblogs.com/oc-bowen/p/6061280.html</div><div class="line">    </div><div class="line">    </div><div class="line">    //    风葉子  星夜飘零的风叶子  止步不前的龃龉  麻仓子叶  木叶夕阳  暮色夕阳 fenng 云岚的风叶子🍃 岚风的叶子🍃  岚山风叶子木  星夜云岚一叶风   潇湘夜雨冷从今</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (NSSet *)createNotificationCategoryActions &#123;</div><div class="line">    </div><div class="line">    //定义按钮的交互button action</div><div class="line">    UNNotificationAction * likeButton = [UNNotificationAction actionWithIdentifier:@&quot;see1&quot; title:@&quot;I love it~&quot; options:UNNotificationActionOptionDestructive|UNNotificationActionOptionForeground];</div><div class="line">    UNNotificationAction * dislikeButton = [UNNotificationAction actionWithIdentifier:@&quot;see2&quot; title:@&quot;I don&apos;t care~&quot; options:UNNotificationActionOptionAuthenticationRequired|UNNotificationActionOptionDestructive|UNNotificationActionOptionForeground];</div><div class="line">    //定义文本框的action</div><div class="line">    UNTextInputNotificationAction * text = [UNTextInputNotificationAction actionWithIdentifier:@&quot;text&quot; title:@&quot;How about it~?&quot; options:UNNotificationActionOptionDestructive|UNNotificationActionOptionForeground];</div><div class="line">    </div><div class="line">    //将这些action带入category</div><div class="line">    UNNotificationCategory * choseCategory = [UNNotificationCategory categoryWithIdentifier:@&quot;seeCategory&quot; actions:@[likeButton,dislikeButton] intentIdentifiers:@[@&quot;see1&quot;,@&quot;see2&quot;] options:UNNotificationCategoryOptionCustomDismissAction];</div><div class="line">    </div><div class="line">    UNNotificationCategory * comment = [UNNotificationCategory categoryWithIdentifier:@&quot;seeCategory1&quot; actions:@[text] intentIdentifiers:@[@&quot;text&quot;] options:UNNotificationCategoryOptionNone];</div><div class="line">    </div><div class="line">    return [NSSet setWithObjects:choseCategory,comment,nil];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)application:(UIApplication *)application didReceiveRemoteNotification:(NSDictionary *)userInfo &#123;</div><div class="line">    </div><div class="line">    [JPUSHService handleRemoteNotification:userInfo];</div><div class="line">    NSLog(@&quot;iOS6及以下系统，收到通知:%@&quot;, userInfo);</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)application:(UIApplication *)application didReceiveRemoteNotification:(NSDictionary *)userInfo fetchCompletionHandler: (void (^)(UIBackgroundFetchResult))completionHandler &#123;</div><div class="line">    </div><div class="line">    NSLog(@&quot;iOS7及以上系统，收到通知:%@&quot;, userInfo);</div><div class="line">    [JPUSHService handleRemoteNotification:userInfo];</div><div class="line">    completionHandler(UIBackgroundFetchResultNewData);</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">//  注册后直接登录</div><div class="line">- (void)registerLogin &#123;</div><div class="line">    </div><div class="line">    UXUserInfo * user = [NSKeyedUnarchiver unarchiveObjectWithFile:KUserFile];</div><div class="line">    </div><div class="line">    if (!user.isLogin) &#123;</div><div class="line">        </div><div class="line">        return;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    NSString * token = [NSString stringWithFormat:@&quot;%@_%@&quot;,user.mid,user.access_token];</div><div class="line">    </div><div class="line">    NSDictionary * para = [NSDictionary dictionaryWithObjectsAndKeys:user.mid,@&quot;mid&quot;,token,@&quot;access_token&quot;, nil];</div><div class="line">    </div><div class="line">    [[WFRequestManager shareManager] postWithUrlString:KRegisterLogin parameters:para result:^(id dic, NSError * error)</div><div class="line">     &#123;</div><div class="line">         if (dic &amp;&amp; !error) &#123;</div><div class="line">             </div><div class="line">             user.isLogin = YES;</div><div class="line">             user.nickName = dic[@&quot;data&quot;][@&quot;nickName&quot;];</div><div class="line">             user.headImg = dic[@&quot;data&quot;][@&quot;headImg&quot;];</div><div class="line">             user.cloudToken = dic[@&quot;data&quot;][@&quot;cloudToken&quot;];</div><div class="line">             </div><div class="line">             NSLog(@&quot;cloudToken %@&quot;, user.cloudToken);</div><div class="line">             </div><div class="line">             </div><div class="line">             [[SDWebImageManager sharedManager] loadImageWithURL:[NSURL URLWithString:user.headImg] options:SDWebImageRetryFailed progress:nil completed:^(UIImage * _Nullable image, NSData * _Nullable data, NSError * _Nullable error, SDImageCacheType cacheType, BOOL finished, NSURL * _Nullable imageURL) &#123;</div><div class="line">                 </div><div class="line">                 user.avatarImg = image;</div><div class="line">                 </div><div class="line">                 NSLog(@&quot;-- login: %d&quot;,user.isLogin);</div><div class="line">                 </div><div class="line">                 [NSKeyedArchiver archiveRootObject:user toFile:KUserFile];</div><div class="line">             &#125;];</div><div class="line">             </div><div class="line">             [self configRongYunSDK];</div><div class="line">             </div><div class="line">         &#125; else &#123;</div><div class="line">             </div><div class="line">             [self configRongYunSDK];</div><div class="line">         &#125;</div><div class="line">         </div><div class="line">         NSLog(@&quot;--- ret: %@&quot;,[dic objectForKey:@&quot;result&quot;][@&quot;msg&quot;]);</div><div class="line">     &#125;];</div><div class="line">&#125;</div><div class="line"></div><div class="line">/*!</div><div class="line"> 获取用户信息</div><div class="line"> </div><div class="line"> @param userId      用户ID</div><div class="line"> @param completion  获取用户信息完成之后需要执行的Block [userInfo:该用户ID对应的用户信息]</div><div class="line"> </div><div class="line"> @discussion SDK通过此方法获取用户信息并显示，请在completion中返回该用户ID对应的用户信息。</div><div class="line"> 在您设置了用户信息提供者之后，SDK在需要显示用户信息的时候，会调用此方法，向您请求用户信息用于显示。</div><div class="line"> */</div><div class="line">- (void)getUserInfoWithUserId:(NSString *)userId</div><div class="line">                   completion:(void (^)(RCUserInfo *userInfo))completion</div><div class="line">&#123;</div><div class="line">    UXUserInfo * user = [NSKeyedUnarchiver unarchiveObjectWithFile:KUserFile];</div><div class="line">    </div><div class="line">    NSLog(@&quot;--- userId: %@&quot;,userId);</div><div class="line">    </div><div class="line">    if ([userId isEqualToString:user.mid]) &#123;</div><div class="line">        </div><div class="line">        RCUserInfo * userInfo = [[RCUserInfo alloc] init];</div><div class="line">        userInfo.userId = userId;</div><div class="line">        userInfo.name = user.nickName;</div><div class="line">        userInfo.portraitUri = user.headImg;</div><div class="line">        </div><div class="line">        return completion(userInfo);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    if ([userId isEqualToString:@&quot;13397671157&quot;]) &#123;</div><div class="line">        </div><div class="line">        RCUserInfo * userInfo = [[RCUserInfo alloc] init];</div><div class="line">        userInfo.userId = userId;</div><div class="line">        userInfo.name = @&quot;和上帝掷骰子&quot;;</div><div class="line">        userInfo.portraitUri = @&quot;http://ww1.sinaimg.cn/thumb150/0069TUQujw8f40m60rxrej30e80e8dgb.jpg&quot;;</div><div class="line">        </div><div class="line">        return completion(userInfo);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    if ([userId isEqualToString:@&quot;Youki&quot;]) &#123;</div><div class="line">        </div><div class="line">        RCUserInfo * userInfo = [[RCUserInfo alloc] init];</div><div class="line">        userInfo.userId = userId;</div><div class="line">        userInfo.name = @&quot;Youki&quot;;</div><div class="line">        userInfo.portraitUri = @&quot;http://ww1.sinaimg.cn/thumb150/0069TUQujw8f40m60rxrej30e80e8dgb.jpg&quot;;</div><div class="line">        </div><div class="line">        return completion(userInfo);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    if ([userId isEqualToString:@&quot;729&quot;]) &#123;</div><div class="line">        </div><div class="line">        RCUserInfo * userInfo = [[RCUserInfo alloc] init];</div><div class="line">        userInfo.userId = userId;</div><div class="line">        userInfo.name = @&quot;渐黄昏&quot;;</div><div class="line">        userInfo.portraitUri = @&quot;http://ww1.sinaimg.cn/mw690/0069TUQugw1fa81keqfiuj30ku0rsacs.jpg&quot;;</div><div class="line">        </div><div class="line">        return completion(userInfo);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">    if ([userId isEqualToString:@&quot;1&quot;]) &#123;</div><div class="line">        </div><div class="line">        RCUserInfo * userInfo = [[RCUserInfo alloc] init];</div><div class="line">        userInfo.userId = userId;</div><div class="line">        userInfo.name = @&quot;系统消息&quot;;</div><div class="line">        userInfo.portraitUri = @&quot;http://ww3.sinaimg.cn/mw690/0069TUQugw1f9qqkxql01j30qo0zkn2r.jpg&quot;;</div><div class="line">        </div><div class="line">        return completion(userInfo);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">    RCUserInfo * userInfo = [[RCUserInfo alloc] init];</div><div class="line">    userInfo.userId = userId;</div><div class="line">    userInfo.name = [NSString stringWithFormat:@&quot;name_%@&quot;,userId];</div><div class="line">    </div><div class="line">    //    userInfo.portraitUri = user.headImg;</div><div class="line">    </div><div class="line">    return completion(userInfo);</div><div class="line">    </div><div class="line">    //    return completion(nil);</div><div class="line">&#125;</div><div class="line"></div><div class="line">//接收消息的回调方法</div><div class="line">- (void)onRCIMReceiveMessage:(RCMessage *)message left:(int)left</div><div class="line">&#123;</div><div class="line">    NSLog(@&quot;-- receive message: %@(%@) %@ &quot;,message.targetId,message.senderUserId,message.content);</div><div class="line">    </div><div class="line">    RCTextMessage *txtMsg = (RCTextMessage*)message.content;</div><div class="line">    NSLog(@&quot;new text: %@&quot;,txtMsg);</div><div class="line">    </div><div class="line">    [[NSNotificationCenter defaultCenter] postNotificationName:@&quot;newMessage&quot; object:@1];</div><div class="line">    </div><div class="line">&#125;</div><div class="line"></div><div class="line">//  查询用户位置授权</div><div class="line">- (void)initCLLocationManager</div><div class="line">&#123;</div><div class="line">    //定位服务是否可用</div><div class="line">    BOOL enable = [CLLocationManager locationServicesEnabled];</div><div class="line">    //是否具有定位权限</div><div class="line">    int status = [CLLocationManager authorizationStatus];</div><div class="line">    if(!enable || status &lt; 3)</div><div class="line">    &#123;</div><div class="line">        //请求权限</div><div class="line">        if ([[UIDevice currentDevice].systemVersion floatValue] &gt;= 8)</div><div class="line">        &#123;</div><div class="line">            //由于IOS8中定位的授权机制改变 需要进行手动授权</div><div class="line">            CLLocationManager  *locationManager = [[CLLocationManager alloc] init];</div><div class="line">            //获取授权认证</div><div class="line">            [locationManager requestAlwaysAuthorization];</div><div class="line">            [locationManager requestWhenInUseAuthorization];</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        UIAlertView *alertView = [[UIAlertView alloc] initWithTitle:nil</div><div class="line">                                                            message:@&quot;无法定位到您所在的城市，请前去开启GPS定位&quot;</div><div class="line">                                                           delegate:self</div><div class="line">                                                  cancelButtonTitle:nil</div><div class="line">                                                  otherButtonTitles:@&quot;取消&quot;,@&quot;去设置&quot;, nil];</div><div class="line">        alertView.tag = 1000;</div><div class="line">        [alertView show];</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">#pragma mark -- UIAlertViewDelegate</div><div class="line"></div><div class="line">- (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex</div><div class="line">&#123;</div><div class="line">    if (buttonIndex == 0)</div><div class="line">    &#123;</div><div class="line">        </div><div class="line">    &#125;</div><div class="line">    else</div><div class="line">    &#123;</div><div class="line">        [self jumpSetting];</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (void)jumpSetting</div><div class="line">&#123;</div><div class="line">    //打开设置页面，去设置定位</div><div class="line">    NSURL *url = [NSURL URLWithString:UIApplicationOpenSettingsURLString];</div><div class="line">    if ([[UIApplication sharedApplication] canOpenURL:url])</div><div class="line">    &#123;</div><div class="line">        [[UIApplication sharedApplication] openURL:url];</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">- (void)applicationWillResignActive:(UIApplication *)application &#123;</div><div class="line">    // Sent when the application is about to move from active to inactive state. This can occur for certain types of temporary interruptions (such as an incoming phone call or SMS message) or when the user quits the application and it begins the transition to the background state.</div><div class="line">    // Use this method to pause ongoing tasks, disable timers, and invalidate graphics rendering callbacks. Games should use this method to pause the game.</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">- (void)applicationDidEnterBackground:(UIApplication *)application &#123;</div><div class="line">    // Use this method to release shared resources, save user data, invalidate timers, and store enough application state information to restore your application to its current state in case it is terminated later.</div><div class="line">    // If your application supports background execution, this method is called instead of applicationWillTerminate: when the user quits.</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">- (void)applicationWillEnterForeground:(UIApplication *)application &#123;</div><div class="line">    // Called as part of the transition from the background to the active state; here you can undo many of the changes made on entering the background.</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">- (void)applicationDidBecomeActive:(UIApplication *)application &#123;</div><div class="line">    // Restart any tasks that were paused (or not yet started) while the application was inactive. If the application was previously in the background, optionally refresh the user interface.</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">- (void)applicationWillTerminate:(UIApplication *)application &#123;</div><div class="line">    // Called when the application is about to terminate. Save data if appropriate. See also applicationDidEnterBackground:.</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">@end</div></pre></td></tr></table></figure>

          
        
      
    </div>

<div style="text-align:center;color: #ccc;font-size:14px;">—————————————— The End ——————————————</div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>





    
      

  

  
  
  



  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://tisfeng.com/2017/07/19/test/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tisfeng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/You729.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="今宵别梦寒">
    </span>


    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/19/test/" itemprop="url">test</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-19T03:41:38+08:00">
                2017-07-19
              </time>
            

            

            
          </span>

          


 <!-- 在下面的位置加上如下代码 -->


 <!-- 在上面的位置加上如上代码 -->

  
          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/07/19/test/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/07/19/test/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          



         
    

         <span class="post-time">
     &nbsp; | &nbsp;
           <span class="post-meta-item-icon">
             <i class="fa fa-file-word-o"></i>
           </span>
           <span class="post-meta-item-text">WordCount:</span>
           <span class="post-count">158字</span>
           
         </span>
    
      <span class="post-time">
     &nbsp; | &nbsp;
           <span class="post-meta-item-icon">
             <i class="fa fa-clock-o"></i>
           </span>
           <span class="post-meta-item-text">min2read:</span>
           <span class="post-count">1分钟</span>
           
         </span>



        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <link rel="stylesheet" type="text/css" href="/assets/css/DPlayer.min.css"><script src="/assets/js/DPlayer.min.js"> </script><script src="/assets/js/APlayer.min.js"> </script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><hr>
<p>十五年前<br>阴凉的晨</p>
<p>恍恍惚惚<br>清晰的诀别</p>
<p>每夜，梦中的你<br>梦中是你</p>
<p>与枕俱醒<br>觉得不是你</p>
<p>另一些人<br>扮演你入我梦中</p>
<p>哪有你，你这样好<br>哪有你这样你</p>
<p> —— 木心</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">//</div><div class="line">//  MPUtilities.m</div><div class="line">//  MacDown</div><div class="line">//</div><div class="line">//  Created by Tzu-ping Chung  on 8/06/2014.</div><div class="line">//  Copyright (c) 2014 Tzu-ping Chung . All rights reserved.</div><div class="line">//</div><div class="line"></div><div class="line">#import &quot;MPUtilities.h&quot;</div><div class="line">#import &quot;NSString+Lookup.h&quot;</div><div class="line">#import &lt;JavaScriptCore/JavaScriptCore.h&gt;</div><div class="line"></div><div class="line">NSString * const kMPStylesDirectoryName = @&quot;Styles&quot;;</div><div class="line">NSString * const kMPStyleFileExtension = @&quot;css&quot;;</div><div class="line">NSString * const kMPThemesDirectoryName = @&quot;Themes&quot;;</div><div class="line">NSString * const kMPThemeFileExtension = @&quot;style&quot;;</div><div class="line">NSString * const kMPPlugInsDirectoryName = @&quot;PlugIns&quot;;</div><div class="line">NSString * const kMPPlugInFileExtension = @&quot;plugin&quot;;</div><div class="line"></div><div class="line">static NSString *MPDataRootDirectory()</div><div class="line">&#123;</div><div class="line">    static NSString *path = nil;</div><div class="line">    if (!path)</div><div class="line">    &#123;</div><div class="line">        NSArray *paths =</div><div class="line">            NSSearchPathForDirectoriesInDomains(NSApplicationSupportDirectory,</div><div class="line">                                                NSUserDomainMask, YES);</div><div class="line">        NSCAssert(paths.count &gt; 0,</div><div class="line">                  @&quot;Cannot find directory for NSApplicationSupportDirectory.&quot;);</div><div class="line">        NSDictionary *infoDictionary = [NSBundle mainBundle].infoDictionary;</div><div class="line">        path = [NSString pathWithComponents:@[paths[0],</div><div class="line">                                              infoDictionary[@&quot;CFBundleName&quot;]]];</div><div class="line">    &#125;</div><div class="line">    return path;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>ddddddd</p>
</blockquote>

          
        
      
    </div>

<div style="text-align:center;color: #ccc;font-size:14px;">—————————————— The End ——————————————</div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>





    
      

  

  
  
  



  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://tisfeng.com/2017/07/18/ibook/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tisfeng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/You729.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="今宵别梦寒">
    </span>


    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/18/ibook/" itemprop="url">ibook</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-18T02:16:22+08:00">
                2017-07-18
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iBook/" itemprop="url" rel="index">
                    <span itemprop="name">iBook</span>
                  </a>
                </span>

                
                
              
            </span>
          


 <!-- 在下面的位置加上如下代码 -->


 <!-- 在上面的位置加上如上代码 -->

  
          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/07/18/ibook/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/07/18/ibook/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          



         
    

         <span class="post-time">
     &nbsp; | &nbsp;
           <span class="post-meta-item-icon">
             <i class="fa fa-file-word-o"></i>
           </span>
           <span class="post-meta-item-text">WordCount:</span>
           <span class="post-count">79字</span>
           
         </span>
    
      <span class="post-time">
     &nbsp; | &nbsp;
           <span class="post-meta-item-icon">
             <i class="fa fa-clock-o"></i>
           </span>
           <span class="post-meta-item-text">min2read:</span>
           <span class="post-count">1分钟</span>
           
         </span>



        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <link rel="stylesheet" type="text/css" href="/assets/css/DPlayer.min.css"><script src="/assets/js/DPlayer.min.js"> </script><script src="/assets/js/APlayer.min.js"> </script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- JiaThis Button BEGIN --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"jiathis_style_24x24"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"jiathis_button_qzone"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"jiathis_button_tsina"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"jiathis_button_tqq"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"jiathis_button_weixin"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"jiathis_button_renren"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"http://www.jiathis.com/share?uid=2139285"</span> <span class="attr">class</span>=<span class="string">"jiathis jiathis_txt jtico jtico_jiathis"</span> <span class="attr">target</span>=<span class="string">"_blank"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"jiathis_counter_style"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="actionscript"></span></div><div class="line"><span class="keyword">var</span> jiathis_config = &#123;data_track_clickback:<span class="string">'true'</span>&#125;;</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"http://v3.jiathis.com/code/jia.js?uid=2139285"</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- JiaThis Button END --&gt;</span></div></pre></td></tr></table></figure>

          
        
      
    </div>

<div style="text-align:center;color: #ccc;font-size:14px;">—————————————— The End ——————————————</div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>





    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/You729.png"
               alt="Tisfeng" />
          <p class="site-author-name" itemprop="name">Tisfeng</p>
           
              <p class="site-description motion-element" itemprop="description">卦不敢算尽  |  畏天道无常 <br> 情不敢至深  |  恐大梦一场</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">22</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">6</span>
                <span class="site-state-item-name">分类</span>
              
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              
                <span class="site-state-item-count">6</span>
                <span class="site-state-item-name">标签</span>
              
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://twitter.com/tisfeng" target="_blank" title="Twitter">
                  
                    <i class="fa fa-fw fa-twitter"></i>
                  
                  Twitter
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              Links
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="https://www.shiyanlou.com/courses" title="实验楼" target="_blank">实验楼</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.imooc.com" title="慕课网" target="_blank">慕课网</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://www.w3cschool.cn" title="w3cschool" target="_blank">w3cschool</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://program-think.blogspot.com" title="编程随想" target="_blank">编程随想</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.ruanyifeng.com/blog" title="阮一峰" target="_blank">阮一峰</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://onevcat.com/#blog" title="OneV" target="_blank">OneV</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://macshuo.com" title="MacTalk" target="_blank">MacTalk</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://note.leodev.me" title="leodev" target="_blank">leodev</a>
                </li>
              
            </ul>
          </div>
        

        



      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Tisfeng</span>
</div>



<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link " href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>



&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;
  <span id="busuanzi_container_site_pv">
  <i class="fa fa-user" aria-hidden="true"></i>
  <span id="busuanzi_value_site_pv"></span>
  </span>
  &nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;
  <span id="busuanzi_container_site_uv">
  <i class="fa fa-eye" aria-hidden="true"></i>
  <span id="busuanzi_value_site_uv"></span>
  </span>

<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>


</div>





        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  
    <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  

    
      <script id="dsq-count-scr" src="https://isfeng-1.disqus.com/count.js" async></script>
    

  
    

  











  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>




  
  
  
  <link rel="stylesheet" href="/lib/algolia-instant-search/instantsearch.min.css">

  
  
  <script src="/lib/algolia-instant-search/instantsearch.min.js"></script>
  

  <script src="/js/src/algolia-search.js?v=5.1.1"></script>



  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  

  

  

  





</body>
</html>
